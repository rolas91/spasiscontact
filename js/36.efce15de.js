(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[36],{"8c9a":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-page",{},[a("div",{staticClass:"q-pa-md q-gutter-md"},[a("div",{staticClass:"row q-gutter-md"},[e.$store.state.internetAvailable?a("q-btn",{staticClass:"bg-primary text-white",attrs:{to:"/formularios/test-holland/nuevo"}},[e._v("\n        Nuevo\n      ")]):e._e(),e.$store.state.internetAvailable&&this.selected.length>0?a("q-btn",{staticClass:"bg-primary text-white",attrs:{to:"/formularios/test-holland/"+this.selected[0].id+"/editar"}},[e._v("\n        Editar\n      ")]):e._e(),e.$store.state.internetAvailable&&this.selected.length>0?a("q-btn",{staticClass:"bg-negative text-white",on:{click:e.preguntarEliminar}},[e._v("\n        Eliminar\n      ")]):e._e(),e.$store.state.internetAvailable&&this.selected.length>0?a("q-btn",{staticClass:"bg-purple text-white",attrs:{disable:this.selected[0].respuestas<=0,title:this.selected[0].respuestas<=0?"No hay respuestas vinculadas a este Test":"",to:"/formularios/test-holland/"+this.selected[0].token+"/respuestas"}},[e._v("\n        Ver respuestas\n      ")]):e._e(),a("q-btn",{staticClass:"bg-primary text-white",attrs:{icon:"autorenew"},on:{click:e.CargarTestsHolland}})],1),a("q-table",{attrs:{dense:e.$q.screen.lt.md,title:"Tests de personalidad",data:e.holland_tests,columns:e.columns,"row-key":"id",selection:"single",selected:e.selected,loading:e.loadingTable,pagination:e.pagination,filter:e.filtro},on:{"update:selected":function(t){e.selected=t},"update:pagination":function(t){e.pagination=t},request:e.onRequest},scopedSlots:e._u([{key:"top",fn:function(){return[a("q-btn",{attrs:{icon:"fas fa-file-excel",dense:"",color:"green",disable:e.loading,label:"Descargar Excel"},on:{click:e.descargarExcel}}),a("q-space"),a("q-input",{attrs:{placeholder:"Buscar",dense:"",debounce:"300",color:"primary"},scopedSlots:e._u([{key:"append",fn:function(){return[a("q-icon",{attrs:{name:"search"}})]},proxy:!0}]),model:{value:e.filtro,callback:function(t){e.filtro=t},expression:"filtro"}})]},proxy:!0},{key:"body",fn:function(t){return[a("q-tr",{attrs:{props:t}},[a("q-td",{attrs:{"auto-width":""}},[a("q-checkbox",{attrs:{dense:""},model:{value:t.selected,callback:function(a){e.$set(t,"selected",a)},expression:"props.selected"}})],1),a("q-td",{key:"nombre",attrs:{props:t}},[e._v("\n            "+e._s(t.row.nombre)+"\n          ")]),a("q-td",{key:"centro",staticStyle:{"text-overflow":"ellipsis","word-break":"keep-all","white-space":"pre-line",height:"auto"},attrs:{props:t}},[e._v("\n            "+e._s(t.row.centro)+"\n          ")]),a("q-td",{key:"respuestas",attrs:{props:t}},[e._v("\n            "+e._s(t.row.respuestas)+"\n          ")]),a("q-td",{key:"fecha_inicio",attrs:{props:t}},[e._v("\n            "+e._s(t.row.fecha_inicio)+"\n          ")]),a("q-td",{key:"fecha_fin",attrs:{props:t}},[e._v("\n            "+e._s(t.row.fecha_fin)+"\n          ")]),a("q-td",{key:"boton",attrs:{props:t}},[a("q-btn",{attrs:{color:"teal",size:"sm",to:"/formularios/test-holland/"+t.row.token+"/responder",disable:!e.fechaValida(t.row.fecha_fin)}},[e._v("\n              responder\n            ")]),a("q-btn",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:e.appUrl+"#/formularios/test-holland/"+t.row.token+"/responder",expression:"\n                `${appUrl}#/formularios/test-holland/${props.row.token}/responder`\n              ",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:e.onCopy,expression:"onCopy",arg:"success"},{name:"clipboard",rawName:"v-clipboard:error",value:e.onError,expression:"onError",arg:"error"}],attrs:{color:"primary",icon:"content_copy",flat:"",size:"sm",disable:!e.fechaValida(t.row.fecha_fin)}})],1),a("q-td",{key:"usuario_creacion",attrs:{props:t}},[e._v("\n            "+e._s(t.row.usuario_creacion)+"\n          ")])],1)]}}])})],1),a("q-dialog",{attrs:{persistent:""},model:{value:e.confirm,callback:function(t){e.confirm=t},expression:"confirm"}},[a("q-card",[a("q-card-section",{staticClass:"row items-center"},[a("q-avatar",{attrs:{icon:"warning",color:"primary","text-color":"white"}}),a("span",{staticClass:"q-ml-sm"},[e._v("\n          Esta seguro que desea eliminar el test seleccionado?\n        ")])],1),a("q-card-actions",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Cancelar",color:"default"}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"bg-primary text-white",attrs:{flat:"",label:"Aceptar"},on:{click:e.eliminarTest}})],1)],1)],1)],1)},r=[],o=(a("c5f6"),a("a34a")),s=a.n(o),i=(a("96cf"),a("c973")),l=a.n(i),c=a("bc3a"),d=a.n(c),u=a("c1df"),p=a.n(u),f={name:"test_holland",data:function(){return{confirm:!1,selected:[],holland_tests:[],loading:!1,loadingTable:!1,filtro:"",id_centro:null,centros:[],pagination:{sortBy:"id",descending:!0,page:1,rowsPerPage:10,rowsNumber:10},columns:[{name:"nombre",required:!0,label:"Nombre",align:"left",field:function(e){return e.nombre},format:function(e){return"".concat(e)},sortable:!0},{name:"centro",required:!0,label:"centro",align:"left",field:function(e){return e.centro},format:function(e){return"".concat(e)},sortable:!0},{name:"respuestas",required:!0,label:"Respuestas",align:"left",field:function(e){return e.respuestas},format:function(e){return"".concat(e)},sortable:!0},{name:"fecha_inicio",required:!0,label:"Fecha Inicio",align:"left",field:function(e){return e.fecha_inicio},format:function(e){return"".concat(p()(e,"DD/MM/YYYY"))},sortable:!0},{name:"fecha_fin",required:!0,label:"Fecha fin",align:"left",field:function(e){return e.fecha_fin},format:function(e){return"".concat(p()(e,"DD/MM/YYYY"))},sortable:!0},{name:"boton",required:!1,label:"Responder",align:"left"},{name:"usuario_creacion",required:!0,label:"Usuario Creación",align:"left",field:function(e){return e.usuario_creacion},format:function(e){return"".concat(p()(e,"DD/MM/YYYY"))},sortable:!0}]}},created:function(){var e=this;return l()(s.a.mark((function t(){return s.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,t.next=3,e.CargarTestsHolland();case 3:return t.next=5,e.CargarCentros();case 5:e.loading=!1;case 6:case"end":return t.stop()}}),t)})))()},methods:{fechaValida:function(e){return p()().isAfter(p()(e,"DD/MM/YYYY"),"day"),!p()().isAfter(p()(e,"DD/MM/YYYY"),"day")},CargarCentros:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.loadingCentros=!0;var a="http://35.203.165.142/api/catalogos/centros",n={Authorization:"Bearer "+this.$store.state.token},r={filtro:t};d()({method:"get",url:a,params:r,headers:n}).then((function(t){e.centros=t.data.centros,e.loadingCentros=!1})).catch((function(t){e.loadingCentros=!1,401===t.response.status&&(e.removeCredentials(),e.$router.push({name:"login"}))}))},descargarExcel:function(){var e=this;this.loading=!0;var t="post",a="http://35.203.165.142/api/formularios/holland_tests/descargar",n={Authorization:"Bearer "+this.$store.state.token};d()({method:t,responseType:"blob",url:a,headers:n}).then((function(t){e.loading=!1;var a=window.URL.createObjectURL(new Blob([t.data])),n=document.createElement("a");n.href=a,n.setAttribute("download","tests de holland.xlsx"),document.body.appendChild(n),n.click()})).catch((function(t){e.loading=!1,e.$q.notify({color:"red-5",textColor:"white",icon:"fas fa-exclamation-triangle",message:t.response.data}),401===t.response.status&&(e.removeCredentials(),e.$router.push({name:"login"}))}))},preguntarEliminar:function(){this.confirm=!0},onCopy:function(e){this.$q.notify({color:"primary",textColor:"white",icon:"content_copy",message:"Copiado al portapapeles!",position:"bottom",timeout:1500})},onError:function(e){this.$q.notify({color:"red-5",textColor:"white",icon:"fas fa-exclamation-triangle",message:"Ha ocurrido un error al intentar copiar la url"})},formatoFecha:function(e){var t=p()(e,"DD/MM/YYYY").format("DD/MM/YYYY");return t},onRequest:function(e){this.CargarTestsHolland(e)},eliminarTest:function(){var e=this,t="http://35.203.165.142/api/formularios/test-holland/destroy/"+this.selected[0].id,a={Authorization:"Bearer "+this.$store.state.token};d()({method:"delete",url:t,headers:a}).then((function(t){t.data.result?(e.$q.notify({color:"green-4",textColor:"white",icon:"fas fa-check-circle",message:"test eliminado correctamente",position:"bottom",timeout:2e3}),e.CargarTestsHolland(),e.selected=[]):e.$q.notify({color:"red-5",textColor:"white",icon:"fas fa-exclamation-triangle",message:t.data.message})})).catch((function(t){e.loading=!1,e.loadingPaises=!1,e.$q.notify({color:"red-5",textColor:"white",icon:"fas fa-exclamation-triangle",message:t.response.data}),401===t.response.status&&(e.removeCredentials(),e.$router.push({name:"login"}))}))},CargarTestsHolland:function(e){var t=this,a=this.pagination.rowsPerPage,n=this.pagination.page,r=this.pagination.sortBy,o=this.pagination.descending;e&&e.pagination&&(n=e.pagination.page,a=e.pagination.rowsPerPage,r=e.pagination.sortBy,o=e.pagination.descending);var s="http://35.203.165.142/api/formularios/test-holland/index";this.loading=!0,this.loadingTable=!0;var i={Authorization:"Bearer "+this.$store.state.token};this.$store.getters.online&&d()({method:"get",url:s,params:{rowsPerPage:a,filtro:this.filtro,page:n,sortBy:r,descending:o,table_format:!0,id_centro:this.id_centro},headers:i}).then((function(e){t.holland_tests=e.data.holland_tests.data,t.holland_tests,t.loading=!1,t.loadingTable=!1,t.pagination.rowsNumber=e.data.holland_tests.total,t.pagination.rowsPerPage=a,t.pagination.page=e.data.holland_tests.current_page,t.pagination.sortBy=r,t.pagination.descending=o})).catch((function(e){console.error("Error en la petición",{error:e})}))}},computed:{appUrl:function(){return"http://34.72.90.164"},id_rol:function(){return Number(this.$store.state.user.rol)||null}}},h=f,g=a("2877"),m=Object(g["a"])(h,n,r,!1,null,null,null);t["default"]=m.exports}}]);