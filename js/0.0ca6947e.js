(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[0],{8265:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("q-layout",{staticClass:"bg-grey-2",attrs:{view:"lHh Lpr lFf"}},[r("q-header",{attrs:{elevated:""}},[r("q-toolbar",{staticClass:"bg-white text-primary"},[r("q-btn",{attrs:{flat:"",dense:"",round:"","aria-label":"Menu"},on:{click:e.toggleDrawer}},[r("q-icon",{attrs:{name:"menu"}})],1),r("q-toolbar-title",[r("q-img",{staticStyle:{height:"80px","max-width":"200px"},attrs:{src:"statics/imagenes-plantilla/logo1.png",contain:"",position:"center"}})],1),r("q-btn",{attrs:{flat:""}},[r("q-tooltip",[e._v("Account")]),r("q-menu",{attrs:{"auto-close":"",offset:[-2,10]}},[r("q-list",{staticStyle:{"min-width":"170px"}},[r("q-item",{attrs:{clickable:""}},[r("q-item-section",{on:{click:e.logOut}},[e._v("Salir")])],1)],1)],1),r("span",[e._v("\n            "+e._s(e.$store.state.user?e.$store.state.user.nombre:"")+"\n        ")])],1)],1)],1),r("q-drawer",{attrs:{mini:e.miniState,bordered:"","content-style":"background-color:#e1ae0e; margin-left: -1px;    background-repeat: round;"},model:{value:e.$store.state.leftDrawerOpen,callback:function(t){e.$set(e.$store.state,"leftDrawerOpen",t)},expression:"$store.state.leftDrawerOpen"}},[r("q-list",[r("q-item-label",{staticClass:"text-white",attrs:{header:""}},[e._v("Menú Principal")]),e._l(this.$store.state.accesos,(function(t){return r("div",{key:t.id},[e.$store.state.internetAvailable?r("div",[t.ver?r("q-item",{attrs:{clickable:"",to:t.path}},[r("q-item-section",{attrs:{avatar:""}},[r("q-icon",{staticClass:"text-white",attrs:{name:t.icon}})],1),r("q-item-section",[r("q-item-label",{staticClass:"text-white",attrs:{title:t.descripcion}},[e._v("\n                "+e._s(t.nombre)+"\n\n              ")])],1)],1):e._e()],1):r("div",["Formularios"===t.nombre?r("q-item",{attrs:{clickable:"",to:t.path}},[r("q-item-section",{attrs:{avatar:""}},[r("q-icon",{staticClass:"text-white",attrs:{name:t.icon}})],1),r("q-item-section",[r("q-item-label",{staticClass:"text-white",attrs:{title:t.descripcion}},[e._v("\n                "+e._s(t.nombre)+"\n\n              ")])],1)],1):e._e()],1)])}))],2)],1),r("q-page-container",[r("router-view"),r("q-ajax-bar",{ref:"bar",attrs:{position:"top",color:"accent",size:"10px","skip-hijack":""}})],1)],1)},n=[],s=(r("ac6a"),r("7514"),r("a34a")),o=r.n(s),i=(r("96cf"),r("c973")),c=r.n(i),u=r("bc3a"),l=r.n(u),p=r("0a93"),h={name:"MyLayout",data:function(){return{syncInProgress:!1,miniState:!1}},created:function(){!this.$store.getters.online&&this.$q.platform.is.mobile?(window.addEventListener("offline",this.handleOffline),window.addEventListener("online",this.handleOnline),this.syncData(),this.$store.commit("setLeftDrawerOpen",!1)):this.$store.commit("setLeftDrawerOpen",!0)},destroyed:function(){!this.$store.getters.online&&this.$q.platform.is.mobile&&(window.removeEventListener("offline",this.handleOffline),window.removeEventListener("online",this.handleOnline))},methods:{logOut:function(){var e=this,t="http://35.203.165.142/api/logout";l.a.post(t,{},{headers:{Accept:"application/json",Authorization:"Bearer "+this.$store.state.token}}).then((function(t){e.removeCredentials(),e.$router.push({name:"login"})})).catch((function(){e.removeCredentials(),e.$router.push({name:"login"})}))},CargarFormularios:function(){var e=this;return c()(o.a.mark((function t(){var r,a,n,s,i,c,u,h,d,m;return o.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r="http://35.203.165.142/api/admin/formularios",e.loading=!0,e.loadingTable=!0,a={Authorization:"Bearer "+e.$store.state.token},n={mobile:!0},t.prev=5,t.next=8,l.a.get(r,{params:n,headers:a});case 8:s=t.sent,i=s.data.formularios.data,c=Object(p["i"])("Formulario"),u=[],h=0;case 13:if(!(h<i.length)){t.next=21;break}return t.next=16,e.CargarDatosFormulario(i[h].url);case 16:d=t.sent,d?(m={duracion:d.duracion,fecha_fin:d.fecha_fin,fecha_inicio:d.fecha_inicio,id:d.id,id_modo:d.id_modo,nombre:d.nombre,nota_maxima:d.nota_maxima,secciones:JSON.stringify(d.secciones),url:d.url},u.push(m)):console.error("No se obtuvo datos para este formulario",i[h]);case 18:h++,t.next=13;break;case 21:return t.next=23,c.save(u);case 23:t.sent,t.next=31;break;case 27:t.prev=27,t.t0=t["catch"](5),e.loading=!1,t.t0;case 31:case"end":return t.stop()}}),t,null,[[5,27]])})))()},CargarDatosFormulario:function(e){var t=this;return c()(o.a.mark((function r(){var a,n,s,i,c,u;return o.a.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(void 0!==e&&""!==e){r.next=2;break}return r.abrupt("return");case 2:return t.loading=!0,a="http://35.203.165.142/api"+"/responder/formulario/".concat(e),n={Authorization:"Bearer "+t.$store.state.token},s={mobile:!0},r.prev=6,r.next=9,l.a.get(a,{params:s,headers:n});case 9:return i=r.sent,c=i.data.formulario,u=i.data.campos,c.secciones=i.data.secciones,u.forEach((function(e,t,r){r[t].tipo_input=JSON.parse(e.tipo_input),r[t].opciones=JSON.parse(e.opciones)})),c.secciones.forEach((function(e,t,r){r[t].campos=u.filter((function(t){return t.id_seccion===e.id}))})),r.abrupt("return",c);case 19:if(r.prev=19,r.t0=r["catch"](6),t.loading=!1,r.t0,401!==r.t0.response.status){r.next=28;break}t.removeCredentials(),t.$router.push({name:"login"}),r.next=29;break;case 28:return r.abrupt("return",null);case 29:case"end":return r.stop()}}),r,null,[[6,19]])})))()},CargarCentros:function(){var e=this;return c()(o.a.mark((function t(){var r,a,n,s,i,c,u,h,d,m,f,v,b,g,x;return o.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r="http://35.203.165.142/api/catalogos/centros_cursos",a={Authorization:"Bearer "+e.$store.state.token},n={mobile:!0},t.prev=3,t.next=6,l.a.get(r,{params:n,headers:a});case 6:return s=t.sent,i=s.data.centros,c=Object(p["i"])("Centro"),u=Object(p["i"])("Curso"),t.next=13,c.save(i);case 13:return t.next=15,c.find();case 15:h=t.sent,d=[],m=0;case 18:if(!(m<h.length)){t.next=33;break}return t.prev=19,t.next=22,e.CargarCursos(h[m].id);case 22:if(f=t.sent,v=f.data.cursos,v){for(b=[],g=0;g<v.length;g++)x=v[g],x.nombre&&x.id&&(b.push(x),d.push(x));h[m].cursos=b}t.next=30;break;case 27:t.prev=27,t.t0=t["catch"](19),t.t0;case 30:m++,t.next=18;break;case 33:if(!(d.length>0)){t.next=36;break}return t.next=36,u.save(d);case 36:return t.next=38,c.save(h);case 38:t.sent,t.next=46;break;case 42:t.prev=42,t.t1=t["catch"](3),console.error("Error updating centros",{error:t.t1},e.syncInProgress),401===t.t1.response.status&&e.logOut();case 46:case"end":return t.stop()}}),t,null,[[3,42],[19,27]])})))()},CargarCursos:function(e){var t=this;return c()(o.a.mark((function r(){var a,n,s;return o.a.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(e){r.next=2;break}return r.abrupt("return");case 2:return t.loadingCursos=!0,a="http://35.203.165.142/api/catalogos/cursos",n={Authorization:"Bearer "+t.$store.state.token},s={id_centro:e,mobile:!0},r.abrupt("return",l.a.get(a,{params:s,headers:n}));case 7:case"end":return r.stop()}}),r)})))()},CargarCursosMatriculas:function(){var e=this;return c()(o.a.mark((function t(){var r,a,n,s,i;return o.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loadingCursosMatriculas=!0,r="http://35.203.165.142/api/admin/cursos_matriculas",a={Authorization:"Bearer "+e.$store.state.token},t.prev=3,t.next=6,l.a.get(r,{params:{mobile:!0},headers:a});case 6:n=t.sent,s=n.data.cursos_matriculas.data,i=Object(p["i"])("Matriculas"),s.map((function(e){var t={id:e.id,id_curso:e.id_curso,id_participante:e.id_participante,nombre:e.nombres_participante+" "+e.apellidos_participante,documento_identidad:e.documento_identidad,telefono:e.telefono,correo:e.correo,data:JSON.stringify(e)};i.save(t).catch((function(e){console.error("Errors found",e)}))})),t.next=15;break;case 12:t.prev=12,t.t0=t["catch"](3),401===t.t0.response.status&&(e.removeCredentials(),e.$router.push({name:"login"}));case 15:case"end":return t.stop()}}),t,null,[[3,12]])})))()},CargarTiposFormularios:function(){var e=this;return c()(o.a.mark((function t(){var r,a,n,s;return o.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:r="get",a="http://35.203.165.142/api/catalogos/tipos_formularios",n={Authorization:"Bearer "+e.$store.state.token},s={mobile:!0},l()({method:r,url:a,params:s,headers:n}).then((function(e){for(var t=e.data.tipos_formularios,r=Object(p["i"])("TipoFormulario"),a=[],n=0;n<t.length;n++){var s=t[n],o={id:s.id,nombre:s.nombre};a.push(o)}r.save(a)})).catch((function(t){console.error("Error saving tipo forms",{error:t}),401===t.response.status&&(e.removeCredentials(),e.$router.push({name:"login"}))}));case 5:case"end":return t.stop()}}),t)})))()},removeCredentials:function(){this.$store.dispatch("removeCredentials")},syncData:function(){var e=this;return c()(o.a.mark((function t(){var r;return o.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.$q.platform,!e.$store.getters.online||!e.$q.platform.is.mobile){t.next=4;break}return t.abrupt("return");case 4:return e.syncInProgress=!0,r=e.$refs.bar,r&&r.start(),e.syncInProgress,t.prev=8,t.next=11,e.CargarDepartamentos();case 11:t.next=16;break;case 13:t.prev=13,t.t0=t["catch"](8),console.error("Error loading depts",t.t0);case 16:return t.prev=16,t.next=19,e.CargarCentros();case 19:t.next=24;break;case 21:t.prev=21,t.t1=t["catch"](16),console.error("Error loading centros",t.t1);case 24:return t.prev=24,t.next=27,e.CargarFormularios();case 27:t.next=32;break;case 29:t.prev=29,t.t2=t["catch"](24),console.error("Error cargando",t.t2);case 32:return t.prev=32,t.next=35,e.CargarCursosMatriculas();case 35:t.next=40;break;case 37:t.prev=37,t.t3=t["catch"](32),console.error("Error cargando",t.t3);case 40:return t.prev=40,t.next=43,e.CargarTiposFormularios();case 43:t.next=48;break;case 45:t.prev=45,t.t4=t["catch"](40),console.error("Error cargando",t.t4);case 48:e.syncInProgress=!1,e.$refs.bar&&e.$refs.bar.stop();case 50:case"end":return t.stop()}}),t,null,[[8,13],[16,21],[24,29],[32,37],[40,45]])})))()},handleOffline:function(e){this.$store.commit("setInternetAvailable",!1),this.syncInProgress=!1},handleOnline:function(e){this.$store.commit("setInternetAvailable",!0),this.syncInProgress||this.syncData()},CargarDepartamentos:function(){var e=this;return c()(o.a.mark((function t(){var r,a,n,s,i,c,u,h,d;return o.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r="http://35.203.165.142/api/catalogos/departamentos",a={Authorization:"Bearer "+e.$store.state.token},n={q:"",id_padre:1438,mobile:!0},t.prev=3,t.next=6,l.a.get(r,{params:n,headers:a});case 6:s=t.sent,i=s.data.departamentos,c=Object(p["i"])("Departamento"),u=Object(p["i"])("Municipio"),h=o.a.mark((function t(r){var a,n,s,l;return o.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=i[r],t.next=3,c.save(a);case 3:return n=t.sent,t.next=7,e.CargarMunicipios(a.id);case 7:return s=t.sent,s.forEach((function(e,t,r){r[t].departamento=n})),t.next=11,u.save(s);case 11:return l=t.sent,n.municipios=l,t.next=15,c.save(n);case 15:case"end":return t.stop()}}),t)})),d=0;case 13:if(!(d<i.length)){t.next=18;break}return t.delegateYield(h(d),"t0",15);case 15:d++,t.next=13;break;case 18:t.next=24;break;case 20:t.prev=20,t.t1=t["catch"](3),console.error("Error loading departamentos",{error:t.t1}),401===t.t1.response.status&&(e.removeCredentials(),e.$router.push({name:"login"}));case 24:case"end":return t.stop()}}),t,null,[[3,20]])})))()},CargarMunicipios:function(e){var t=this;return c()(o.a.mark((function r(){var a,n,s,i;return o.a.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a="http://35.203.165.142/api/catalogos/municipios",n={Authorization:"Bearer "+t.$store.state.token},s={filtro:"",id_padre:e},r.next=5,l.a.get(a,{headers:n,params:s});case 5:return i=r.sent,r.abrupt("return",i.data.municipios);case 7:case"end":return r.stop()}}),r)})))()},toggleDrawer:function(){if(!this.$store.getters.online&&this.$q.platform.is.mobile)return this.$store.state.leftDrawerOpen&&!this.miniState?void(this.miniState=!0):this.$store.state.leftDrawerOpen&&this.miniState?void(this.miniState=!1):void(this.$store.state.leftDrawerOpen||this.miniState||(this.$store.commit("setLeftDrawerOpen",!0),this.miniState=!1));this.$store.commit("setLeftDrawerOpen",!this.$store.state.leftDrawerOpen)}}},d=h,m=(r("f6a0"),r("2877")),f=Object(m["a"])(d,a,n,!1,null,null,null);t["default"]=f.exports},b4cd:function(e,t,r){},f6a0:function(e,t,r){"use strict";var a=r("b4cd"),n=r.n(a);n.a}}]);