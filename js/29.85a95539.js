(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[29],{"2b6f":function(e,t,a){"use strict";var o=a("47b6"),s=a.n(o);s.a},"47b6":function(e,t,a){},"4de0":function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-page",[a("div",{staticClass:"q-pa-md q-gutter-md"},[a("div",{staticClass:"row q-gutter-md"},[a("q-btn",{staticClass:"bg-primary text-white",on:{click:e.nuevoRolesAcceso}},[e._v("\n        Nuevo\n      ")]),e.selected.length>0?a("q-btn",{staticClass:"bg-primary text-white",on:{click:e.editarRolesAcceso}},[e._v("\n        Editar\n      ")]):e._e(),e.selected.length>0?a("q-btn",{staticClass:"bg-negative text-white",on:{click:e.pregunarEliminar}},[e._v("\n        Eliminar\n      ")]):e._e(),a("q-btn",{staticClass:"bg-primary text-white",attrs:{icon:"autorenew"},on:{click:e.CargarRolesAccesos}})],1),a("q-table",{attrs:{dense:e.$q.screen.lt.md,title:"RolesAccesos",data:e.roles_accesos,columns:e.columns,"row-key":"id_rol",selection:"single",selected:e.selected,loading:e.loadingTable,pagination:e.pagination,filter:e.filtro},on:{"update:selected":function(t){e.selected=t},"update:pagination":function(t){e.pagination=t},request:e.onRequest},scopedSlots:e._u([{key:"top-right",fn:function(){return[a("q-input",{attrs:{dense:"",debounce:"300",placeholder:"Buscar"},scopedSlots:e._u([{key:"append",fn:function(){return[a("q-icon",{attrs:{name:"search"}})]},proxy:!0}]),model:{value:e.filtro,callback:function(t){e.filtro=t},expression:"filtro"}})]},proxy:!0}])})],1),this.selected.length>0&&e.modalOpen?a("q-dialog",{attrs:{maximized:e.$q.screen.lt.md,"full-width":e.$q.screen.lt.md,"full-height":e.$q.screen.lt.md,persistent:""},model:{value:e.modalOpen,callback:function(t){e.modalOpen=t},expression:"modalOpen"}},[a("q-card",{staticStyle:{width:"100%","max-width":"100vw"}},[a("q-card-section",{staticClass:"bg-primary text-white q-gutter-sm"},[a("h5",[e._v(e._s(e.nuevo?"Nuevo Rol Acceso":"Editar Rol Acceso"))])]),a("q-separator"),a("q-card-section",[a("q-form",{on:{submit:e.onSubmit}},[a("div",{staticClass:"row q-col-gutter-md"},[a("div",{staticClass:"col-12"},[a("q-select",{attrs:{label:"Rol",options:e.roles,"lazy-rules":"",rules:[function(e){return e||"Ingrese un Rol v√°lido"}],"option-value":"id","option-label":"nombre","emit-value":"","map-options":""},on:{input:e.setRol},scopedSlots:e._u([{key:"no-option",fn:function(){return[a("q-item",[a("q-item-section",{staticClass:"text-grey"},[e._v("\n                      No hay resultados disponibles\n                    ")])],1)]},proxy:!0}],null,!1,2138845739),model:{value:e.id_rol,callback:function(t){e.id_rol=t},expression:"id_rol"}})],1)]),a("div",{staticClass:"row q-col-gutter-md"},[a("div",{staticClass:"col-12"},[a("h5",[e._v("Permisos")]),a("q-list",{staticStyle:{"background-color":"white"},attrs:{dense:"",padding:""}},[a("q-item-label",{attrs:{header:""}},[a("div",{staticClass:"row q-col-gutter-md bg-green text-white"},[a("div",{staticClass:"col-3"},[a("label")]),a("div",{staticClass:"col-2"},[a("label",[e._v("Ver")])]),a("div",{staticClass:"col-2"},[a("label",[e._v("Crear")])]),a("div",{staticClass:"col-2"},[a("label",[e._v("Editar")])]),a("div",{staticClass:"col-2"},[a("label",[e._v("Eliminar")])])])]),e._l(e.accesos,(function(t){return a("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],key:t.id,attrs:{tag:"label"}},[a("q-item-section",[a("div",{staticClass:"row"},[a("div",{staticClass:"col-3"},[a("q-item-label",{staticClass:"label-item"},[e._v("\n                          "+e._s(t.acceso)+"\n                        ")])],1),a("div",{staticClass:"col-2"},[a("q-checkbox",{attrs:{readonly:e.readonly},model:{value:t.ver,callback:function(a){e.$set(t,"ver",a)},expression:"option.ver"}})],1),a("div",{staticClass:"col-2"},[a("q-checkbox",{attrs:{readonly:e.readonly},model:{value:t.crear,callback:function(a){e.$set(t,"crear",a)},expression:"option.crear"}})],1),a("div",{staticClass:"col-2"},[a("q-checkbox",{attrs:{readonly:e.readonly},model:{value:t.editar,callback:function(a){e.$set(t,"editar",a)},expression:"option.editar"}})],1),a("div",{staticClass:"col-2"},[a("q-checkbox",{attrs:{readonly:e.readonly},model:{value:t.eliminar,callback:function(a){e.$set(t,"eliminar",a)},expression:"option.eliminar"}})],1)])])],1)}))],2)],1)]),a("q-card-actions",{staticClass:"row justify-between q-gutter-sm"},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{right:"",icon:"close"}},[e._v("Cancelar")]),a("q-btn",{staticClass:"bg-primary text-white",attrs:{loading:e.loading,disable:e.loading,right:"",type:"submit",icon:"save"}},[e._v("\n              Guardar\n            ")])],1)],1)],1)],1)],1):e._e(),a("q-dialog",{attrs:{persistent:""},model:{value:e.confirm,callback:function(t){e.confirm=t},expression:"confirm"}},[a("q-card",[a("q-card-section",{staticClass:"row items-center"},[a("q-avatar",{attrs:{icon:"warning",color:"primary","text-color":"white"}}),a("span",{staticClass:"q-ml-sm"},[e._v("\n          Esta seguro que desea eliminar el roles_acceso seleccionado?\n        ")])],1),a("q-card-actions",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Cancelar",color:"default"}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"bg-primary text-white",attrs:{flat:"",label:"Aceptar"},on:{click:e.eliminarRolesAcceso}})],1)],1)],1)],1)},s=[],i=a("a34a"),r=a.n(i),n=(a("96cf"),a("c973")),c=a.n(n),l=a("bc3a"),d=a.n(l),u=a("c1df"),p=a.n(u),m={data:function(){return{readonly:!1,confirm:!1,selectAllAccesos:!1,nuevo:!0,selected:[],visibleColumns:["id","id_acceso","id_rol","ver","crear","editar","eliminar"],id_rol:null,roles_accesos:[],accesos:[],roles:[],loading:!1,loadingAccesos:!1,loadingRoles:!1,modalOpen:!1,loadingTable:!1,filtro:"",pagination:{sortBy:"id",descending:!0,page:1,rowsPerPage:10,rowsNumber:10},columns:[{name:"roles",required:!0,label:"Rol",align:"left",field:function(e){return e.rol},format:function(e){return"".concat(e)},sortable:!0}]}},created:function(){var e=this;return c()(r.a.mark((function t(){return r.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,t.next=3,e.CargarRolesAccesos();case 3:return t.next=5,e.CargarAccesos();case 5:return t.next=7,e.CargarRoles();case 7:e.loading=!1;case 8:case"end":return t.stop()}}),t)})))()},methods:{setRol:function(){var e=this;this.accesos.forEach((function(t,a,o){o[a].id_rol=e.id_rol}))},onRequest:function(e){this.CargarRolesAccesos(e)},nuevoRolesAcceso:function(){this.modalOpen=!0,this.nuevo=!0,this.LimpiarDatos()},pregunarEliminar:function(){this.confirm=!0},eliminarRolesAcceso:function(){var e=this,t="http://35.203.165.142/api/admin/roles_accesos/"+this.selected[0].id,a={Authorization:"Bearer "+this.$store.state.token};d()({method:"delete",url:t,headers:a}).then((function(t){e.$q.notify({color:"green-4",textColor:"white",icon:"fas fa-check-circle",message:"RolesAcceso eliminado correctamente",position:"bottom",timeout:2e3}),e.modalOpen=!1,e.LimpiarDatos(),e.CargarRolesAccesos(),e.selected=[]})).catch((function(t){e.loading=!1,e.$q.notify({color:"red-5",textColor:"white",icon:"fas fa-exclamation-triangle",message:t.response.data}),401===t.response.status&&(e.removeCredentials(),e.$router.push({name:"login"}))}))},editarRolesAcceso:function(){var e=this;return c()(r.a.mark((function t(){return r.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.nuevo=!1,t.next=3,e.cargarPermisos();case 3:e.modalOpen=!0;case 4:case"end":return t.stop()}}),t)})))()},cargarPermisos:function(){var e=this;this.loadingAccesos=!0;var t="".concat("http://35.203.165.142/api","/catalogos/rolesAccesos/edit"),a={Authorization:"Bearer "+this.$store.state.token},o={id_rol:this.selected[0].id_rol};d()({method:"get",url:t,headers:a,params:o}).then((function(t){e.accesos=t.data.accesos,e.id_rol=t.data.id_rol,e.CargarRoles(),e.loadingAccesos=!1})).catch((function(t){e.loadingAccesos=!1,401===t.response.status&&(e.removeCredentials(),e.$router.push({name:"login"}))}))},LimpiarDatos:function(){this.id_rol=null,this.accesos.forEach((function(e,t,a){a[t].ver=!1,a[t].crear=!1,a[t].editar=!1,a[t].eliminar=!1}))},removeCredentials:function(){this.$store.dispatch("removeCredentials")},filtrarRolesAccesos:function(e,t,a){var o=this;t((function(){o.CargarRolesAccesos(e)}))},filtrarAccesos:function(e,t,a){var o=this;t((function(){o.CargarAccesos(e)}))},filtrarRoles:function(e,t,a){var o=this;t((function(){o.CargarRoles(e)}))},isValidDate:function(e){return p()(e,"DD/MM/YYYY",!0).isValid()},onSubmit:function(){var e=this;this.loading=!0;var t="post",a="http://35.203.165.142/api/admin/roles_accesos";this.nuevo||(a="http://35.203.165.142/api/admin/roles_accesos/"+this.selected[0].id,t="put");var o={Authorization:"Bearer "+this.$store.state.token},s=this.accesos;s.map((function(e,t,a){a[t].nombre=void 0,a[t].id=void 0,a[t].created_at=p()().format("YYYY/MM/MM")})),d()({method:t,url:a,data:{roles_accesos:s},headers:o}).then((function(t){e.$q.notify({color:"green-4",textColor:"white",icon:"fas fa-check-circle",message:"RolesAcceso creado correctamente",position:"bottom",timeout:2e3}),e.modalOpen=!1,e.LimpiarDatos(),e.CargarRolesAccesos(),e.selected=[]})).catch((function(t){e.loading=!1,e.$q.notify({color:"red-5",textColor:"white",icon:"fas fa-exclamation-triangle",message:t.response.data}),401===t.response.status&&(e.removeCredentials(),e.$router.push({name:"login"}))}))},CargarRolesAccesos:function(e){var t=this,a=this.pagination.rowsPerPage,o=this.pagination.page;e&&e.pagination&&(a=e.pagination.rowsPerPage),this.loadingRolesAccesos=!0;var s="http://35.203.165.142/api/admin/roles_accesos",i={Authorization:"Bearer "+this.$store.state.token};this.loadingTable=!0,d()({method:"get",url:s,params:{rowsPerPage:a,filtro:this.filtro,page:o},headers:i}).then((function(e){t.loadingTable=!1,t.roles_accesos=e.data.roles_accesos.data,t.loadingRolesAccesos=!1,t.roles_accesos=e.data.roles_accesos.data,t.loading=!1,t.loadingRolesAccesos=!1,t.pagination.rowsNumber=e.data.roles_accesos.total,t.pagination.rowsPerPage=a})).catch((function(e){t.loadingTable=!1,t.loadingRolesAccesos=!1,401===e.response.status&&(t.removeCredentials(),t.$router.push({name:"login"}))}))},CargarAccesos:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.loadingAccesos=!0;var a="http://35.203.165.142/api/catalogos/accesos",o={Authorization:"Bearer "+this.$store.state.token},s={q:t};d()({method:"get",url:a,params:s,headers:o}).then((function(t){e.accesos=t.data.accesos,e.loadingAccesos=!1})).catch((function(t){e.loadingAccesos=!1,401===t.response.status&&(e.removeCredentials(),e.$router.push({name:"login"}))}))},CargarRoles:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.loadingRoles=!0;var a="http://35.203.165.142/api/catalogos/roles",o={Authorization:"Bearer "+this.$store.state.token},s={q:t};d()({method:"get",url:a,params:s,headers:o}).then((function(t){e.roles=t.data.roles,e.loadingRoles=!1})).catch((function(t){e.loadingRoles=!1,401===t.response.status&&(e.removeCredentials(),e.$router.push({name:"login"}))}))}}},h=m,g=(a("2b6f"),a("2877")),f=Object(g["a"])(h,o,s,!1,null,"73e656be",null);t["default"]=f.exports}}]);