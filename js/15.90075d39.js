(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[15],{e6be:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-page",[a("div",{staticClass:"q-pa-md q-gutter-md"},[a("div",{staticClass:"row q-gutter-md"},[e.id_curso?a("q-btn",{staticClass:"bg-primary text-white",attrs:{to:"/admin/cursos/"+this.id_curso+"/inscribir"}},[e._v("\n        Nueva Inscripción\n      ")]):e._e(),e.selected.length&&e.id_curso?a("q-btn",{staticClass:"bg-primary text-white",attrs:{to:{name:"inscripcion_editar",params:{idCurso:e.id_curso,idMatricula:e.selected[0].id}}}},[e._v("\n        Editar\n      ")]):e._e(),e.selected.length&&e.id_curso&&e.selected[0].id_estado>=5532?a("q-btn",{class:0==e.selected[0].egresado?"bg-green text-white":"bg-red text-white",on:{click:e.pregunarEgresado}},[e._v("\n        "+e._s(0==e.selected[0].egresado?"Marcar como egresado":"Marcar como no egresado")+"\n      ")]):e._e(),e.selected&&e.selected.length>0&&e.selected[0].id_estado<=5532&&e.opcionEsVisible("btnEliminar")?a("q-btn",{staticClass:"bg-negative text-white",on:{click:e.pregunarEliminar}},[e._v("\n        Eliminar\n      ")]):e._e(),a("q-btn",{staticClass:"bg-primary text-white",attrs:{icon:"autorenew"},on:{click:e.CargarCursosMatriculas}})],1),a("div",{staticClass:"row  q-gutter-md"},[1===e.id_rol||2===e.id_rol?a("div",{staticClass:"col-12 col-md-5"},[a("q-select",{attrs:{dense:"",label:"Centro",options:e.centros,"lazy-rules":"",rules:[function(e){return e||"Seleccione un Centro de estudio"}],"option-value":"id","option-label":"nombre","emit-value":"","map-options":""},on:{input:function(t){return e.cargarCursos("",!0)}},scopedSlots:e._u([{key:"no-option",fn:function(){return[a("q-item",[a("q-item-section",{staticClass:"text-grey"},[e._v("\n                      No hay resultados disponibles\n                    ")])],1)]},proxy:!0}],null,!1,2138845739),model:{value:e.id_centro,callback:function(t){e.id_centro=t},expression:"id_centro"}})],1):e._e(),a("div",{staticClass:"col-12 col-md-6"},[a("q-select",{attrs:{dense:"","use-input":"","input-debounce":"200",label:"Curso",options:e.cursos,loading:e.loadingCursos,"lazy-rules":"",rules:[function(e){return e||"Ingrese un Curso válido"}],"option-value":"id","option-label":"nombre","hide-selected":"","fill-input":"","emit-value":"","map-options":""},on:{filter:e.filtrarCursos,input:function(t){return e.SetIdMatricula()}},scopedSlots:e._u([{key:"no-option",fn:function(){return[a("q-item",[a("q-item-section",{staticClass:"text-grey"},[e._v("\n            No hay resultados disponibles\n          ")])],1)]},proxy:!0}]),model:{value:e.id_curso,callback:function(t){e.id_curso=t},expression:"id_curso"}})],1)]),e.curso?a("div",{staticClass:"row q-pa"},[a("div",{staticClass:"col-md-4"},[a("h5",[e._v(e._s(e.curso.tipo)+": "+e._s(e.curso.nombre))])])]):e._e(),e.curso?a("div",{staticClass:"row q-gutted-md"},[a("div",{staticClass:"col-12 col-md-4"},[e._v("\n        Cupos Restantes: "+e._s(e.curso.cupos_disponibles)+"\n      ")]),a("div",{staticClass:"col-12 col-md-4"},[e._v("\n        Último día para inscribirse: "+e._s(e.curso.fecha_fin_matricula)+"\n      ")]),a("div",{staticClass:"col-12 col-md-4"},[e._v("\n        Fecha de inicio del curso: "+e._s(e.curso.fecha_inicio)+"\n      ")])]):e._e(),a("q-table",{attrs:{dense:e.$q.screen.lt.md,title:"Inscripciones",data:e.cursos_matriculas,columns:e.columns,"row-key":"id",selection:"single",selected:e.selected,loading:e.loadingTable,pagination:e.pagination,filter:e.filtro},on:{"update:selected":function(t){e.selected=t},"update:pagination":function(t){e.pagination=t},request:e.onRequest},scopedSlots:e._u([{key:"top",fn:function(){return[a("q-btn",{attrs:{icon:"fas fa-file-excel",dense:"",color:"green",disable:e.loading,label:"Descargar Excel"},on:{click:e.descargarExcel}}),a("q-space"),a("q-input",{attrs:{placeholder:"Buscar",dense:"",debounce:"300",color:"primary"},scopedSlots:e._u([{key:"append",fn:function(){return[a("q-icon",{attrs:{name:"search"}})]},proxy:!0}]),model:{value:e.filtro,callback:function(t){e.filtro=t},expression:"filtro"}})]},proxy:!0}])})],1),a("q-dialog",{attrs:{persistent:""},model:{value:e.confirm,callback:function(t){e.confirm=t},expression:"confirm"}},[a("q-card",[a("q-card-section",{staticClass:"row items-center"},[a("q-avatar",{attrs:{icon:"warning",color:"primary","text-color":"white"}}),a("span",{staticClass:"q-ml-sm"},[e._v("\n          Esta seguro que desea eliminar el cursos_matricula seleccionado?\n        ")])],1),a("q-card-actions",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Cancelar",color:"default"}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"bg-primary text-white",attrs:{flat:"",label:"Aceptar"},on:{click:e.eliminarCursosMatricula}})],1)],1)],1),a("q-dialog",{attrs:{persistent:""},model:{value:e.egresadoConfirm,callback:function(t){e.egresadoConfirm=t},expression:"egresadoConfirm"}},[a("q-card",[a("q-card-section",{},[a("q-avatar",{attrs:{icon:"warning",color:"primary","text-color":"white"}}),a("span",{staticClass:"q-ml-sm"},[e._v("\n          Esta seguro que desea al participante como\n          "+e._s(e.selected.length>0&&e.selected[0].egresado?"no":"")+"\n          egresado?\n        ")]),a("div",{staticClass:"q-pa-md"},[a("div",{staticClass:"q-pa-md"},[e.selected.length>0?a("q-input",{attrs:{label:"Nota/Calificación",type:"number",outlined:""},model:{value:e.selected[0].calificacion,callback:function(t){e.$set(e.selected[0],"calificacion",t)},expression:"selected[0].calificacion"}}):e._e()],1),a("div",{staticClass:"q-pa-md"},[e.selected.length>0?a("q-input",{attrs:{label:"Comentarios",outlined:"",type:"textarea"},model:{value:e.selected[0].comentarios,callback:function(t){e.$set(e.selected[0],"comentarios",t)},expression:"selected[0].comentarios"}}):e._e()],1)])],1),a("q-card-actions",{attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Cancelar",color:"default"}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"bg-primary text-white",attrs:{flat:"",label:"Aceptar"},on:{click:e.toggleParticipanteEgresado}})],1)],1)],1)],1)},i=[],o=(a("7f7f"),a("a34a")),n=a.n(o),s=(a("c5f6"),a("96cf"),a("c973")),c=a.n(s),l=a("bc3a"),u=a.n(l),d={data:function(){return{confirm:!1,egresadoConfirm:!1,id_curso:null,readonly:!1,selected:[],curso:null,visibleColumns:["id","id_curso","id_estudiante","nombres_estudiante","apellidos_estudiante","telefono","id_tipo_identificacion","documento_identidad","edad","id_estado_civil","sexo","id_pais","id_departamento","id_municipio","direccion","id_nivel_educacion","estudiando","curso_estudiando","trabajando","lugar_trabajo","salario","calificacion"],cursos_matriculas:[],cursos:[],centros:[],id_centro:null,loading:!1,loadingTable:!1,loadingCursos:!1,filtro:"",pagination:{sortBy:"id",descending:!0,page:1,rowsPerPage:10,rowsNumber:10},columns:[{name:"participante",required:!0,label:"Participante",align:"left",field:function(e){return e.participante},format:function(e){return"".concat(e)},sortable:!0},{name:"documento_identidad",required:!0,label:"Cédula",align:"left",field:function(e){return e.documento_identidad},format:function(e){return"".concat(e)},sortable:!0},{name:"centro",required:!0,label:"Centro",align:"left",field:function(e){return e.centro},format:function(e){return"".concat(e)},sortable:!0},{name:"egresado",required:!0,label:"Egresado",align:"left",field:function(e){return e.egresado?"✓":"x"},format:function(e){return"".concat(e)},sortable:!0,style:"font-size:18px;font-weight:600;"},{name:"codigo",required:!0,label:"Código",align:"left",field:function(e){return e.codigo},format:function(e){return"".concat(e)},sortable:!0},{name:"curso",required:!0,label:"Curso",align:"left",field:function(e){return e.curso},format:function(e){return"".concat(e)},sortable:!0},{name:"calificacion",required:!0,label:"Calificacion",align:"left",field:function(e){return e.calificacion},format:function(e){return"".concat(e)},sortable:!0},{name:"comentarios",required:!0,label:"Comentarios",align:"left",field:function(e){return e.comentarios},format:function(e){return"".concat(e)},sortable:!0},{name:"edad",required:!0,label:"Edad",align:"left",field:function(e){return e.edad},format:function(e){return"".concat(e)},sortable:!0},{name:"estado_civil",required:!0,label:"Estado civil",align:"left",field:function(e){return e.estado_civil},format:function(e){return"".concat(e)},sortable:!0},{name:"sexo",required:!0,label:"Sexo",align:"left",field:function(e){return e.sexo},format:function(e){return"".concat(e)},sortable:!0},{name:"pais",required:!0,label:"Pais",align:"left",field:function(e){return e.pais},format:function(e){return"".concat(e)},sortable:!0},{name:"departamento",required:!0,label:"Departamento",align:"left",field:function(e){return e.departamento},format:function(e){return"".concat(e)},sortable:!0},{name:"municipio",required:!0,label:"Municipio",align:"left",field:function(e){return e.municipio},format:function(e){return"".concat(e)},sortable:!0},{name:"direccion",required:!0,label:"Dirección",align:"left",field:function(e){return e.direccion},format:function(e){return"".concat(e)},sortable:!0},{name:"nivel_academico",required:!0,label:"Nivel academico",align:"left",field:function(e){return e.nivel_academico},format:function(e){return"".concat(e)},sortable:!0},{trabajando:"desc",required:!0,label:"Trabajando",align:"left",field:function(e){return e.trabajando?"Si":"No"},format:function(e){return"".concat(e)},sortable:!0},{lugar_trabajo:"desc",required:!0,label:"Lugar Trabajo",align:"left",field:function(e){return e.lugar_trabajo?e.lugar_trabajo:"-"},format:function(e){return"".concat(e)},sortable:!0},{salario:"desc",required:!0,label:"Salario",align:"left",field:function(e){return e.salario},format:function(e){return"".concat(e)},sortable:!0}]}},created:function(){var e=this;return c()(n.a.mark((function t(){return n.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,e.id_curso=Number(e.$route.params.id),t.next=4,e.CargarCursosMatriculas();case 4:return t.next=6,e.CargarCurso(!0);case 6:return t.next=8,e.cargarCursos();case 8:return t.next=10,e.CargarCentros();case 10:4===e.id_rol&&(e.id_centro=e.$store.state.centros[0]);case 11:case"end":return t.stop()}}),t)})))()},methods:{CargarCentros:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.loadingCentros=!0;var a="http://35.203.165.142/api/catalogos/centros",r={Authorization:"Bearer "+this.$store.state.token},i={filtro:t};u()({method:"get",url:a,params:i,headers:r}).then((function(t){e.centros=t.data.centros,e.loadingCentros=!1})).catch((function(t){e.loadingCentros=!1,401===t.response.status&&(e.removeCredentials(),e.$router.push({name:"login"}))}))},descargarExcel:function(){var e=this;this.loading=!0;var t="post",a="http://35.203.165.142/api/inscripciones/descargar",r={Authorization:"Bearer "+this.$store.state.token};u()({method:t,responseType:"blob",url:a,headers:r,params:{id_curso:Number(this.$route.params.id)}}).then((function(t){e.loading=!1;var a=window.URL.createObjectURL(new Blob([t.data])),r=document.createElement("a");r.href=a,r.setAttribute("download","inscripciones.xlsx"),document.body.appendChild(r),r.click()})).catch((function(t){e.loading=!1}))},opcionEsVisible:function(e){var t=null;switch(e){case"btnVer":t=this.tienePermiso(e);break;case"btnNuevo":t=this.tienePermiso(e);break;case"btnEditar":t=this.tienePermiso(e)&&5534!==this.selected[0].id_estado&&5558!==this.selected[0].id_estado;break;case"btnAprobar":t=this.tienePermiso(e)&&5531===this.selected[0].id_estado;break;case"btnCompletar":t=this.tienePermiso(e)&&5533===this.selected[0].id_estado;break;case"btnFinalizar":t=this.tienePermiso(e);break;case"btnEliminar":t=this.tienePermiso(e)&&this.selected[0].id_estado<=5533;break;case"btninscripciones":t=this.tienePermiso(e)&&this.selected[0].id_estado>=5532;break;case"btnNotas":t=this.tienePermiso(e)&&5533===this.selected[0].id_estado;break;default:t=!1;break}return t},tienePermiso:function(e){var t=Number(this.$store.state.user.rol),a=null;switch(e){case"btnVer":a=1===t||2===t||4===t;break;case"btnNuevo":a=1===t||2===t||4===t;break;case"btnEditar":a=1===t||2===t||4===t;break;case"btnAprobar":a=1===t||2===t;break;case"btnCompletar":a=1===t||2===t||4===t;break;case"btnFinalizar":a=1===t||2===t;break;case"btnEliminar":a=1===t||2===t;break;case"btninscripciones":a=1===t||2===t||4===t||5===t;break;case"btnNotas":a=1===t||2===t||4===t||5===t;break;default:a=!1;break}return a},SetIdMatricula:function(){var e=this;this.$router.push({name:"curso_inscripciones",params:{id:this.id_curso}}),setTimeout((function(){e.CargarCursosMatriculas(),e.CargarCurso()}),300)},onRequest:function(e){this.CargarCursosMatriculas(e)},cargarCursos:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.loadingCursos=!0;var r="http://35.203.165.142/api/admin/catalogos/cursos",i={Authorization:"Bearer "+this.$store.state.token};a&&(this.id_curso=null);var o=Number(this.$store.state.user.rol),n=null;1!==o&&2!==o||(n=this.id_centro);var s={filter:t,id_centro:n};u()({method:"get",url:r,params:s,headers:i}).then((function(t){e.cursos=t.data.cursos,e.loadingCursos=!1})).catch((function(t){e.loadingCursos=!1,401===t.response.status&&(e.removeCredentials(),e.$router.push({name:"login"}))}))},pregunarEliminar:function(){this.confirm=!0},pregunarEgresado:function(){this.egresadoConfirm=!0},eliminarCursosMatricula:function(){var e=this,t="http://35.203.165.142/api/admin/cursos_matriculas/"+this.selected[0].id,a={Authorization:"Bearer "+this.$store.state.token};u()({method:"delete",url:t,headers:a}).then((function(t){e.$q.notify({color:"green-4",textColor:"white",icon:"fas fa-check-circle",message:"CursosMatricula eliminado correctamente",position:"bottom",timeout:2e3}),e.CargarCursosMatriculas(),e.selected=[]})).catch((function(t){e.loading=!1,e.$q.notify({color:"red-5",textColor:"white",icon:"fas fa-exclamation-triangle",message:t.response.data}),401===t.response.status&&(e.removeCredentials(),e.$router.push({name:"login"}))}))},toggleParticipanteEgresado:function(){var e=this,t="http://35.203.165.142/api/admin/cursos_matriculas/"+this.selected[0].id+"/toggle-egresado",a={Authorization:"Bearer "+this.$store.state.token};u()({method:"post",url:t,params:{calificacion:this.selected[0].calificacion,comentarios:this.selected[0].comentarios},headers:a}).then((function(t){e.$q.notify({color:"green-4",textColor:"white",icon:"fas fa-check-circle",message:"Se ha cambiado el estado correctamente",position:"bottom",timeout:2e3}),e.CargarCursosMatriculas(),e.selected=[]})).catch((function(t){e.loading=!1,e.$q.notify({color:"red-5",textColor:"white",icon:"fas fa-exclamation-triangle",message:t.response.data}),401===t.response.status&&(e.removeCredentials(),e.$router.push({name:"login"}))}))},removeCredentials:function(){this.$store.dispatch("removeCredentials")},filtrarCursosMatriculas:function(e,t,a){var r=this;t((function(){r.CargarCursosMatriculas(e)}))},filtrarCursos:function(e,t,a){var r=this;t((function(){""==e&&0!==r.cursos.length||r.cargarCursos(e)}))},CargarCursosMatriculas:function(e){var t=this,a=this.pagination.rowsPerPage,r=this.pagination.page;e&&e.pagination&&(r=e.pagination.page,a=e.pagination.rowsPerPage),this.loadingCursosMatriculas=!0;var i="http://35.203.165.142/api/admin/cursos_matriculas",o={Authorization:"Bearer "+this.$store.state.token};this.loadingTable=!0,this.selected=[],u()({method:"get",url:i,params:{rowsPerPage:a,filtro:this.filtro,page:r,id_curso:this.$route.params.id,mobile:"todas_matriculas"===this.$route.name},headers:o}).then((function(e){t.loadingTable=!1,t.cursos_matriculas=e.data.cursos_matriculas.data,t.cursos_matriculas=e.data.cursos_matriculas.data,t.loading=!1,t.loadingCursosMatriculas=!1,t.pagination.rowsNumber=e.data.cursos_matriculas.total,t.pagination.rowsPerPage=a,t.pagination.page=e.data.cursos_matriculas.current_page})).catch((function(e){t.loadingTable=!1,t.loadingCursosMatriculas=!1,401===e.response.status&&(t.removeCredentials(),t.$router.push({name:"login"}))}))},CargarCurso:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.$route.params.id){var a="http://35.203.165.142/api"+"/admin/cursos/".concat(this.$route.params.id,"/edit"),r={Authorization:"Bearer "+this.$store.state.token};u()({method:"get",url:a,headers:r}).then((function(a){e.curso=a.data.curso,t&&(e.id_centro=Number(e.curso.id_centro)),e.curso,e.cargarCursos()})).catch((function(t){e.loading=!1,401===t.response.status&&(e.removeCredentials(),e.$router.push({name:"login"}))}))}}},computed:{id_rol:function(){return Number(this.$store.state.user.rol)}}},m=d,f=a("2877"),p=Object(f["a"])(m,r,i,!1,null,null,null);t["default"]=p.exports}}]);