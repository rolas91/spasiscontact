(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[22],{"1a8f":function(e,t,n){},3274:function(e,t,n){"use strict";var a=n("1a8f"),r=n.n(a);r.a},3945:function(e,t,n){"use strict";n.r(t);var a,r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-page",[n("div",{staticClass:"q-pa-md q-gutter-md"},[n("div",{staticClass:"row q-gutter-md"},[e.opcionEsVisible("btnNuevo")?n("q-btn",{staticClass:"bg-primary text-white",attrs:{to:"/admin/centros/nuevo"},on:{click:e.nuevoCentro}},[e._v("\n        Nuevo\n      ")]):e._e(),e.selected.length>0&&e.opcionEsVisible("btnEditar")&&"Activo"==e.selected[0].estado?n("q-btn",{staticClass:"bg-primary text-white",attrs:{to:"/admin/centros/"+this.selected[0].id+"/editar"},on:{click:e.editarCentro}},[e._v("\n        Editar\n      ")]):e._e(),e.selected.length>0&&!e.selected[0].deleted_at&&e.opcionEsVisible("btnInactivar")?n("q-btn",{staticClass:"bg-negative text-white",on:{click:e.preguntarInactivar}},[e._v("\n        Inactivar\n      ")]):e._e(),e.selected.length>0&&e.selected[0].deleted_at&&e.opcionEsVisible("btnReactivar")?n("q-btn",{staticClass:"bg-green text-white",on:{click:e.preguntarReactivar}},[e._v("\n        Activar\n      ")]):e._e(),n("q-btn",{staticClass:"bg-primary text-white",attrs:{icon:"autorenew",loading:e.loadingCentros,disabled:e.loadingCentros},on:{click:e.CargarCentros},scopedSlots:e._u([{key:"loading",fn:function(){return[n("q-spinner-gears")]},proxy:!0}])})],1),n("q-table",{attrs:{dense:e.$q.screen.lt.md,title:"Centros",data:e.centros,columns:e.columns,"row-key":"id",selection:"single",selected:e.selected,loading:e.loadingTable,pagination:e.pagination,filter:e.filtro},on:{"update:selected":function(t){e.selected=t},"update:pagination":function(t){e.pagination=t},request:e.onRequest},scopedSlots:e._u([{key:"top",fn:function(){return[1==e.idRol||2==e.idRol?n("q-btn",{attrs:{icon:"fas fa-file-excel",dense:"",color:"green",disable:e.loading,label:"Descargar Excel"},on:{click:e.descargarExcel}}):e._e(),n("q-space"),n("q-input",{attrs:{placeholder:"Buscar",dense:"",debounce:"300",color:"primary"},scopedSlots:e._u([{key:"append",fn:function(){return[n("q-icon",{attrs:{name:"search"}})]},proxy:!0}]),model:{value:e.filtro,callback:function(t){e.filtro=t},expression:"filtro"}})]},proxy:!0},{key:"body",fn:function(t){return[n("q-tr",{attrs:{props:t}},[n("q-td",{attrs:{"auto-width":""}},[n("q-checkbox",{attrs:{dense:""},model:{value:t.selected,callback:function(n){e.$set(t,"selected",n)},expression:"props.selected"}})],1),n("q-td",{key:"nombre",class:t.row.deleted_at?"text-red":"text-black",attrs:{props:t}},[e._v("\n            "+e._s(t.row.nombre)+"\n            "),n("q-btn",{attrs:{dense:"",round:"",flat:"",icon:t.expand?"arrow_drop_up":"arrow_drop_down"},on:{click:function(e){t.expand=!t.expand}}})],1),n("q-td",{key:"foto_representante",attrs:{props:t}},[t.row.foto_representante?n("img",{staticStyle:{width:"50px"},attrs:{src:e.FotoUrl+"/"+t.row.foto_representante,alt:""}}):e._e()]),n("q-td",{key:"departamento",attrs:{props:t}},[e._v("\n            "+e._s(t.row.departamento)+"\n          ")]),n("q-td",{key:"municipio",attrs:{props:t}},[e._v("\n            "+e._s(t.row.municipio)+"\n          ")]),n("q-td",{key:"estado",class:t.row.deleted_at?"text-red":"text-green",attrs:{props:t}},[e._v("\n            "+e._s(t.row.deleted_at?"Inactivo":"Activo")+"\n          ")]),n("q-td",{key:"tipo",attrs:{props:t}},[e._v("\n            "+e._s(t.row.tipo)+"\n          ")]),n("q-td",{key:"direccion",attrs:{props:t}},[e._v("\n            "+e._s(t.row.direccion)+"\n          ")]),n("q-td",{key:"contacto_nombre",attrs:{props:t}},[e._v("\n            "+e._s(t.row.contacto_nombre)+"\n          ")]),n("q-td",{key:"contacto_telefono",attrs:{props:t}},[e._v("\n            "+e._s(t.row.contacto_telefono)+"\n          ")]),n("q-td",{key:"contacto_correo",attrs:{props:t}},[e._v("\n            "+e._s(t.row.contacto_correo)+"\n          ")]),n("q-td",{key:"telefono",attrs:{props:t}},[e._v(e._s(t.row.telefono))]),n("q-td",{key:"correo",attrs:{props:t}},[e._v(e._s(t.row.correo))]),n("q-td",{key:"web_url",attrs:{props:t}},[e._v(e._s(t.row.web_url))])],1),n("q-tr",{directives:[{name:"show",rawName:"v-show",value:t.expand,expression:"props.expand"}],attrs:{props:t}},[n("q-td",{attrs:{colspan:"100%"}},[e.CursosXCentro(t.row.id)&&e.CursosXCentro(t.row.id).length>0?n("div",e._l(e.CursosXCentro(t.row.id),(function(t){return n("div",{key:t.id,staticClass:"row text-left flex",staticStyle:{"margin-top":"5px"}},[n("div",{staticClass:"col-12 col-md-3"},[e._v("\n                  "+e._s(t.codigo)+" "+e._s(t.tipo.nombre)+" -\n                  "+e._s(t.nombre)+"\n                ")]),n("div",{staticClass:"col-12 col-md-6 text-left"},[n("q-btn",{staticClass:"bg-primary text-white",attrs:{flat:"",size:"sm",to:"/admin/cursos/"+t.id+"/ver"}},[e._v("\n                    Ver detalle\n                  ")])],1)])})),0):n("div",{staticClass:"text-left"},[e._v("\n              Este centro no tiene cursos relacionados\n            ")])])],1)]}}])})],1),n("q-dialog",{attrs:{persistent:""},model:{value:e.confirmInactivar,callback:function(t){e.confirmInactivar=t},expression:"confirmInactivar"}},[n("q-card",[n("q-card-section",{staticClass:"row items-center"},[n("q-avatar",{attrs:{icon:"warning",color:"primary","text-color":"white"}}),n("span",{staticClass:"q-ml-sm"},[e._v("\n          Esta seguro que desea inactivar el centro seleccionado?\n        ")])],1),n("q-card-actions",{attrs:{align:"right"}},[n("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Cancelar",color:"default"}}),n("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"bg-primary text-white",attrs:{flat:"",label:"Aceptar"},on:{click:e.inactivarCentro}})],1)],1)],1),n("q-dialog",{attrs:{persistent:""},model:{value:e.confirmReactivar,callback:function(t){e.confirmReactivar=t},expression:"confirmReactivar"}},[n("q-card",[n("q-card-section",{staticClass:"row items-center"},[n("q-avatar",{attrs:{icon:"warning",color:"primary","text-color":"white"}}),n("span",{staticClass:"q-ml-sm"},[e._v("\n          Esta seguro que desea reactivar el centro seleccionado?\n        ")])],1),n("q-card-actions",{attrs:{align:"right"}},[n("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Cancelar",color:"default"}}),n("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"bg-primary text-white",attrs:{flat:"",label:"Aceptar"},on:{click:e.reactivarCentro}})],1)],1)],1)],1)},o=[],i=(n("c5f6"),n("9523")),s=n.n(i),c=n("a34a"),l=n.n(c),d=(n("96cf"),n("c973")),u=n.n(d),p=n("bc3a"),f=n.n(p),m=n("5a9c"),g={data:function(){return{confirmInactivar:!1,confirmReactivar:!1,FotoUrl:"http://35.203.165.142/public/img/fotos_representantes",selected:[],centros:[],cursos:[],loading:!1,modalOpen:!1,loadingTable:!1,filtro:"",pagination:{sortBy:"id",descending:!0,page:1,rowsPerPage:20,rowsNumber:10},columns:[{name:"nombre",required:!0,label:"Nombre",align:"left",field:function(e){return e.nombre},sortable:!0},{name:"foto_representante",required:!0,label:"Foto Representante",align:"left",field:function(e){return e.foto_representante},sortable:!0},{name:"departamento",required:!0,label:"Departamento",align:"left",field:function(e){return e.departamento},sortable:!0},{name:"municipio",required:!0,label:"Municipio",align:"left",field:function(e){return e.municipio},sortable:!0},{name:"estado",required:!0,label:"Estado",align:"left",field:function(e){return null===e.deleted_at},sortable:!0},{name:"tipo",required:!0,label:"tipo",align:"left",field:function(e){return e.tipo},sortable:!0},{name:"direccion",required:!0,label:"Direcci√≥n",align:"left",field:function(e){return e.direccion},sortable:!0},{name:"contacto_nombre",required:!0,label:"Contacto Nombre",align:"left",field:function(e){return e.contacto_nombre},sortable:!0},{name:"contacto_telefono",required:!0,label:"Contacto Telefono",align:"left",field:function(e){return e.contacto_telefono},sortable:!0},{name:"contacto_correo",required:!0,label:"Contacto Correo",align:"left",field:function(e){return e.contacto_correo},sortable:!0},{name:"telefono",required:!0,label:"Telefono",align:"left",field:function(e){return e.telefono},sortable:!0},{name:"correo",required:!0,label:"Correo",align:"left",field:function(e){return e.correo},sortable:!0},{name:"web_url",required:!0,label:"Web",align:"left",field:function(e){return e.web_url},sortable:!0}]}},created:function(){var e=this;return u()(l.a.mark((function t(){return l.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,t.next=3,e.CargarCentros();case 3:e.loading=!1;case 4:case"end":return t.stop()}}),t)})))()},methods:(a={tienePermiso:function(e){var t=null;switch(e){case"btnNuevo":t=Object(m["a"])();break;case"btnEditar":t=Object(m["d"])();break;case"btnInactivar":t=Object(m["h"])();break;case"btnReactivar":t=Object(m["h"])();break;default:t=!1;break}return t},opcionEsVisible:function(e){var t=null;switch(e){case"btnNuevo":t=this.tienePermiso(e);break;case"btnEditar":t=this.tienePermiso(e);break;case"btnInactivar":t=this.tienePermiso(e);break;case"btnReactivar":t=this.tienePermiso(e);break;default:t=!1;break}return t},descargarExcel:function(){var e=this;this.loading=!0;var t="post",n="http://35.203.165.142/api/centros/descargar",a={Authorization:"Bearer "+this.$store.state.token};f()({method:t,responseType:"blob",url:n,headers:a}).then((function(t){e.loading=!1;var n=window.URL.createObjectURL(new Blob([t.data])),a=document.createElement("a");a.href=n,a.setAttribute("download","centros.xlsx"),document.body.appendChild(a),a.click()})).catch((function(t){e.loading=!1,e.$q.notify({color:"red-5",textColor:"white",icon:"fas fa-exclamation-triangle",message:t.response.data}),401===t.response.status&&(e.removeCredentials(),e.$router.push({name:"login"}))}))},nuevoCentro:function(){},editarCentro:function(){},onRequest:function(e){this.CargarCentros(e)},preguntarInactivar:function(){this.confirmInactivar=!0},preguntarReactivar:function(){this.confirmReactivar=!0},reactivarCentro:function(){var e=this,t="http://35.203.165.142/api/admin/centros/reactivar/"+this.selected[0].id,n={Authorization:"Bearer "+this.$store.state.token};f()({method:"post",url:t,headers:n}).then((function(t){e.$q.notify({color:"green-4",textColor:"white",icon:"fas fa-check-circle",message:"Centro eliminado correctamente",position:"bottom",timeout:2e3}),e.modalOpen=!1,e.CargarCentros(),e.selected=[]})).catch((function(t){e.loading=!1,e.$q.notify({color:"red-5",textColor:"white",icon:"fas fa-exclamation-triangle",message:t.response.data.message}),401===t.response.status&&(e.removeCredentials(),e.$router.push({name:"login"}))}))},removeCredentials:function(){this.$store.dispatch("removeCredentials")},inactivarCentro:function(){var e=this,t="http://35.203.165.142/api/admin/centros/"+this.selected[0].id,n={Authorization:"Bearer "+this.$store.state.token};f()({method:"delete",url:t,headers:n}).then((function(t){e.$q.notify({color:"green-4",textColor:"white",icon:"fas fa-check-circle",message:"Centro eliminado correctamente",position:"bottom",timeout:2e3}),e.modalOpen=!1,e.CargarCentros(),e.selected=[]})).catch((function(t){e.loading=!1,e.$q.notify({color:"red-5",textColor:"white",icon:"fas fa-exclamation-triangle",message:t.response.data.message}),401===t.response.status&&(e.removeCredentials(),e.$router.push({name:"login"}))}))}},s()(a,"removeCredentials",(function(){this.$store.dispatch("removeCredentials")})),s()(a,"filtrarCentros",(function(e,t,n){var a=this;t((function(){a.CargarCentros(e)}))})),s()(a,"CargarCentros",(function(e){var t=this,n=this.pagination.rowsPerPage,a=this.pagination.page,r=this.pagination.sortBy,o=this.pagination.descending;e&&e.pagination&&(a=e.pagination.page,n=e.pagination.rowsPerPage,r=e.pagination.sortBy,o=e.pagination.descending),this.loadingCentros=!0;var i="http://35.203.165.142/api/admin/centros",s={Authorization:"Bearer "+this.$store.state.token};this.loadingTable=!0,f()({method:"get",url:i,params:{rowsPerPage:n,filtro:this.filtro,page:a,sortBy:r,descending:o},headers:s}).then((function(e){e.data,t.loadingTable=!1,t.centros=e.data.centros.data,t.cursos=e.data.cursos,t.loadingCentros=!1,t.centros=e.data.centros.data,t.loading=!1,t.loadingCentros=!1,t.pagination.rowsNumber=e.data.centros.total,t.pagination.rowsPerPage=n,t.pagination.page=e.data.centros.current_page,t.pagination.sortBy=r,t.pagination.descending=o})).catch((function(e){t.loadingTable=!1,t.loadingCentros=!1,t.$q.notify({color:"red-5",textColor:"white",icon:"fas fa-exclamation-triangle",message:e.response.data.message}),401===e.response.status&&(t.removeCredentials(),t.$router.push({name:"login"}))}))})),s()(a,"CursosXCentro",(function(e){return this.cursos.filter((function(t){return t.id_centro===e}))})),a),computed:{idRol:function(){return Number(this.$store.state.user.rol)}}},b=g,v=(n("3274"),n("2877")),h=Object(v["a"])(b,r,o,!1,null,"4f9c35c0",null);t["default"]=h.exports}}]);