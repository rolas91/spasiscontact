(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[11],{"1dcb":function(i,e,t){},a5b0:function(i,e,t){"use strict";var o=t("1dcb"),a=t.n(o);a.a},ae24:function(i,e,t){"use strict";t.r(e);var o=function(){var i=this,e=i.$createElement,t=i._self._c||e;return t("q-layout",{attrs:{view:"lHh Lpr lFf"}},[t("q-page-container",{staticClass:"bg-grey-2"},[t("q-page",{staticClass:"q-pa-md pagina",attrs:{id:"responder-formulario"}},[t("q-dialog",{attrs:{persistent:""},model:{value:i.confirm,callback:function(e){i.confirm=e},expression:"confirm"}},[t("q-card",[t("q-card-section",{staticClass:"row items-center"},[t("q-avatar",{attrs:{icon:"warning",color:"primary","text-color":"white"}}),t("span",{staticClass:"q-ml-sm"},[i._v("\n              Hay un borrador guardado, desea continuar o iniciar uno nuevo?\n            ")])],1),t("q-card-actions",{attrs:{align:"right"}},[t("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Nuevo",color:"default"},on:{click:i.nuevoFormulario}}),t("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"bg-primary text-white",attrs:{flat:"",label:"Continuar"},on:{click:i.continuar}})],1)],1)],1),i.formulario&&5605==i.formulario.id_modo||!i.iniciado&&!i.correoVerificado&&!i.finalizado?t("q-card",[i.formulario&&5605!=i.formulario.id_modo?t("q-card-section",[t("q-form",{attrs:{id:"formularioValidacion"},on:{submit:i.validarUsuario}},[t("h5",[i._v("\n              Por favor ingresa tus datos para poder continuar con el\n              formulario\n            ")]),i.formulario&&5603==i.formulario.id_modo?t("div",{staticClass:"row q-col-gutter-md"},[t("div",{staticClass:"col-12 col-md-6"},[t("q-select",{attrs:{outlined:"",label:"Modo Autenticación",options:i.tipos_identidad,"lazy-rules":"",rules:[function(i){return i&&i.length>0||"Éste campo es requerido"}],"emit-value":"","map-options":""},scopedSlots:i._u([{key:"no-option",fn:function(){return[t("q-item",[t("q-item-section",{staticClass:"text-grey"},[i._v("\n                        No hay resultados disponibles\n                      ")])],1)]},proxy:!0}],null,!1,3222682283),model:{value:i.tipo_identidad,callback:function(e){i.tipo_identidad=e},expression:"tipo_identidad"}})],1),t("div",{staticClass:"col-12 col-md-6"},[t("q-input",{attrs:{outlined:"",type:"text",label:i.tipo_identidad,"lazy-rules":"",rules:[function(i){return i&&i.length||"Éste campo es requerido"}]},model:{value:i.doc_identidad,callback:function(e){i.doc_identidad=e},expression:"doc_identidad"}})],1)]):i._e(),i.formulario&&5603==i.formulario.id_modo?t("div",{staticClass:"row q-col-gutter-md"},[t("div",{staticClass:"col-12 col-md-6"},[t("q-select",{attrs:{outlined:"",label:"Centro de estudio",options:i.centros,loading:i.loadingCentros,"option-value":"id","option-label":"nombre","emit-value":"","map-options":"","lazy-rules":"",rules:[function(i){return i||"Éste campo es requerido"}]},on:{input:i.CargarCursos},scopedSlots:i._u([{key:"no-option",fn:function(){return[t("q-item",[t("q-item-section",{staticClass:"text-grey"},[i._v("\n                        No hay resultados disponibles\n                      ")])],1)]},proxy:!0}],null,!1,3222682283),model:{value:i.id_centro,callback:function(e){i.id_centro=e},expression:"id_centro"}})],1),t("div",{staticClass:"col-12 col-md-6"},[t("q-select",{attrs:{outlined:"",label:"Seleccione el curso",options:i.cursos,loading:i.loadingCursos,"option-value":"id","option-label":"nombre","emit-value":"","map-options":"","lazy-rules":"",rules:[function(i){return i||"Éste campo es requerido"}]},scopedSlots:i._u([{key:"no-option",fn:function(){return[t("q-item",[t("q-item-section",{staticClass:"text-grey"},[i._v("\n                        No hay resultados disponibles\n                      ")])],1)]},proxy:!0}],null,!1,3222682283),model:{value:i.id_curso,callback:function(e){i.id_curso=e},expression:"id_curso"}})],1)]):i._e(),i.formulario&&5604==i.formulario.id_modo?t("div",[t("div",{staticClass:"row q-pa-sm q-col-gutter-md"},[t("div",{staticClass:"col-12 col-md-6"},[t("q-input",{attrs:{outlined:"",label:"Nombre completo","lazy-rules":"",rules:[function(i){return i&&i.length>0||"Ingresa tu nombre completo"}]},model:{value:i.formulario.nombre_participante,callback:function(e){i.$set(i.formulario,"nombre_participante",e)},expression:"formulario.nombre_participante"}})],1),t("div",{staticClass:"col-12 col-md-6"},[t("q-input",{attrs:{outlined:"",label:"correo electrónico","lazy-rules":"",rules:[function(e){return e&&i.emailRegex.test(e)||"Ingresa un correo electrónico válido"}]},model:{value:i.formulario.correo_participante,callback:function(e){i.$set(i.formulario,"correo_participante",e)},expression:"formulario.correo_participante"}})],1)])]):i._e(),t("br"),i.formulario&&5605!=i.formulario.id_modo?t("div",{staticClass:"row"},[t("div",{staticClass:"col-12"},[t("q-btn",{attrs:{type:"submit",color:"primary"}},[i._v("Siguiente")])],1)]):i._e()])],1):i._e()],1):i._e(),!i.iniciado&&i.correoVerificado?t("q-card",[t("q-card-section",[t("div",{staticClass:"row"},[t("div",{staticClass:"col-12",staticStyle:{display:"flex","justify-content":"center"}},[t("h5",[i._v("\n                Bienvenido\n                "),t("span",{staticStyle:{color:"#027be3"}},[i._v("\n                  "+i._s(5603==i.formulario.id_modo?i.formulario.participante.nombre:5604==i.formulario.id_modo?i.formulario.nombre_participante:"")+"\n                  !!\n                ")])])]),t("div",{staticClass:"col-12",staticStyle:{display:"flex","justify-content":"center"}},[t("h5",[i._v("\n                Presiona el boton iniciar para comenzar a rellenar este\n                formulario\n              ")])])]),t("div",{staticClass:"row"},[t("div",{staticClass:"col-12",staticStyle:{display:"flex","justify-content":"center"}},[t("q-btn",{staticClass:"centered",attrs:{color:"primary"},on:{click:i.iniciarFormulario}},[i._v("\n                Iniciar\n              ")])],1)])])],1):i._e(),null!=i.formulario&&i.iniciado&&!i.finalizado?t("div",[t("q-card",{staticClass:"q-pa-md"},[t("q-card-section",[t("div",{staticClass:"row q-col-gutter-md"},[t("div",{staticClass:"col-4"},[t("q-img",{staticStyle:{height:"80px","max-width":"250px"},attrs:{src:"statics/imagenes-plantilla/logo1.png",contain:"",position:"center"}})],1),t("div",{staticClass:"offset-4 col-4"},[t("q-img",{staticStyle:{height:"80px","max-width":"180px"},attrs:{src:"statics/imagenes-plantilla/wfp_logo.jpg",contain:"",position:"center"}})],1)]),t("div",{staticClass:"seccion"},[t("br"),t("br"),i.formulario.duracion>0?t("div",{staticStyle:{"margin-bottom":"20px"},attrs:{id:"timer"}},[t("q-icon",{attrs:{name:"far fa-clock"}}),i._v("\n                Tiempo restante "+i._s(i.minutos)+" Minutos :\n                "+i._s(i.segundos)+" Segundos\n              ")],1):i._e(),t("div",{staticClass:"row q-col-gutter-md"},[t("label",{staticClass:"titulo text-primary"},[i._v("\n                  "+i._s(i.formulario.secciones[i.page].titulo)+"\n                ")])]),t("div",{staticClass:"row q-col-gutter-md"},[t("label",{domProps:{innerHTML:i._s(i.formulario.secciones[i.page].descripcion)}})]),t("br"),t("label",{staticClass:"pregunta"},[i._v("\n                Los campos con\n                "),t("span",{staticStyle:{color:"#c10015","font-size":"20px",display:"inline"}},[i._v("\n                  *\n                ")]),i._v("\n                son requeridos\n              ")]),t("br"),t("br"),t("br"),i._l(i.formulario.secciones[i.page].campos,(function(e,o){return t("div",{key:o},[t("div",{staticClass:"row q-col-gutter-lg q-pa-md"},[t("div",{staticClass:"col-12"},[i.campoVisible(e)?t("label",{staticClass:"pregunta q-mb-md q-mt-md flex"},[i._v("\n                      "+i._s(o+1+".")+" "+i._s(e.texto)+"\n                      "),t("span",{staticStyle:{color:"#c10015","font-size":"20px",display:"inline"}},[i._v("\n                        "+i._s(e.requerido?"*":"")+"\n                      ")])]):i._e(),e.imagen&&i.campoVisible(e)?t("q-img",{staticClass:"imagen q-mb-md",attrs:{src:e.imagen,"spinner-color":"white",contain:""}}):i._e(),i.campoVisible(e)?t("label",{staticClass:"pregunta q-mt-md"},[i._v("\n                      "+i._s(e.subtitulo)+"\n                    ")]):i._e(),2==e.id_tipo&&1==e.tipo_input.id&&i.campoVisible(e)?t("q-input",{attrs:{outlined:"",type:"text","input-style":"text-transform: uppercase;",error:!e.isValid,"error-message":"Este campo es requerido","lazy-rules":"",rules:[function(i){return!i||i&&e.requerido||!e.requerido||"Este campo es requerido"}]},model:{value:e.respuesta,callback:function(t){i.$set(e,"respuesta",t)},expression:"campo.respuesta"}}):i._e(),2==e.id_tipo&&2==e.tipo_input.id&&i.campoVisible(e)?t("q-input",{attrs:{type:"textarea",outlined:"",error:!e.isValid,"error-message":"Este campo es requerido","lazy-rules":"",rules:[function(i){return!i||i&&e.requerido||!e.requerido||"Este campo es requerido"}]},model:{value:e.respuesta,callback:function(t){i.$set(e,"respuesta",t)},expression:"campo.respuesta"}}):i._e(),2==e.id_tipo&&3==e.tipo_input.id&&i.campoVisible(e)?t("q-input",{attrs:{outlined:"",type:"number",error:!e.isValid,"error-message":"Ingrese un valor válido para el campo","lazy-rules":"",rules:[function(t){return!t||t&&e.requerido&&i.validarMinimosYMaximos(e,t)||!e.requerido||"Ingrese un valor válido para el campo"}]},model:{value:e.respuesta,callback:function(t){i.$set(e,"respuesta",i._n(t))},expression:"campo.respuesta"}}):i._e(),2==e.id_tipo&&4==e.tipo_input.id&&i.campoVisible(e)?t("q-input",{attrs:{outlined:"","lazy-rules":"",rules:[function(t){return i.isValidDate(t)&&/\d{1,2}\/\d{1,2}\/\d{4}/.test(t)||!e.requerido||"Ingrese un fecha válida"}],error:!e.isValid,"error-message":"Ingrese una fecha válida"},scopedSlots:i._u([{key:"append",fn:function(){return[t("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[t("q-popup-proxy",{ref:"qDateProxy"+e.id,refInFor:!0,attrs:{"transition-show":"scale","transition-hide":"scale"}},[t("q-date",{attrs:{mask:"DD/MM/YYYY","lazy-rules":"",rules:[function(i){return i&&i.length>0||"Ingrese una fecha válida"}]},on:{input:function(){return i.hideDatePopUp("qDateProxy"+e.id)}},model:{value:e.respuesta,callback:function(t){i.$set(e,"respuesta",t)},expression:"campo.respuesta"}})],1)],1)]},proxy:!0}],null,!0),model:{value:e.respuesta,callback:function(t){i.$set(e,"respuesta",t)},expression:"campo.respuesta"}}):i._e(),1==e.id_tipo&&1==e.tipo_input.id&&i.campoVisible(e)?t("div",{staticClass:"row q-col-gutter-md q-pa-md"},[t("div",{staticClass:"col-12 q-col-gutter-md"},i._l(e.opciones,(function(o){return t("q-radio",{key:o.id,attrs:{val:o.nombre,label:o.nombre,error:!e.isValid,"error-message":"Este campo es requerido"},model:{value:e.respuesta,callback:function(t){i.$set(e,"respuesta",t)},expression:"campo.respuesta"}})})),1),e.isValid||!e.requerido||e.respuesta?i._e():t("label",{staticStyle:{color:"#c10015","font-size":"12px"}},[i._v("\n                        Selecciona una opción\n                      ")])]):i._e(),1==e.id_tipo&&3==e.tipo_input.id&&i.campoVisible(e)?t("q-select",{attrs:{"bg-color":"white",options:e.opciones,"lazy-rules":"","emit-value":"","map-options":"","option-value":"nombre","option-label":"nombre",error:!e.isValid,"error-message":"Selecciona una opción",rules:[function(i){return i&&e.requerido||!e.requerido||"Selecciona una opción"}]},model:{value:e.respuesta,callback:function(t){i.$set(e,"respuesta",t)},expression:"campo.respuesta"}}):i._e(),1==e.id_tipo&&2==e.tipo_input.id&&i.campoVisible(e)?t("div",[t("div",{staticClass:"row"},[t("q-list",{staticStyle:{"background-color":"white"},attrs:{dense:"",padding:""}},i._l(e.opciones,(function(o){return t("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],key:o.id,attrs:{tag:"label"}},[t("q-item-section",{attrs:{side:"",top:""}},[t("q-checkbox",{attrs:{error:!e.isValid,"error-message":e.texto+" es requerido","true-value":o.nombre,"false-value":!1},model:{value:o.respuesta,callback:function(e){i.$set(o,"respuesta",e)},expression:"option.respuesta"}})],1),t("q-item-section",[t("q-item-label",[i._v(i._s(o.nombre))])],1)],1)})),1)],1),e.isValid||!e.requerido||e.respuesta?i._e():t("label",{staticStyle:{color:"#c10015","font-size":"12px"}},[i._v("\n                        Selecciona una opción\n                      ")])]):i._e(),3==e.id_tipo&&e.arregloTable&&e.arregloTable.length>0&&i.campoVisible(e)?t("div",{staticClass:"row"},[t("div",{staticClass:"col-12"},[t("table",{staticClass:"full-width bg-white q-mt-md"},[t("thead",{staticClass:"full-width text-center"},[t("td"),i._l(e.arregloTable[0].columns,(function(e){return t("td",{key:e.id},[i._v("\n                              "+i._s(e.valor)+"\n                            ")])}))],2),i._l(e.arregloTable,(function(o){return t("tr",{key:o.id,class:o.isValid?"":"error"},[t("span",{staticClass:"flex q-mt-md"},[i._v(i._s(o.valor))]),i._l(o.columns,(function(a,r){return t("td",{key:a.id,staticClass:"text-center"},[t("q-radio",{staticClass:"text-right",attrs:{val:!0},on:{input:function(t){return i.setFilaCheckbox(e,o,o.columns[r])}},model:{value:o.columns[r].checked,callback:function(e){i.$set(o.columns[r],"checked",e)},expression:"fila.columns[index2].checked"}})],1)}))],2)}))],2),!e.isValid&&e.requerido?t("label",{staticStyle:{color:"#c10015","font-size":"12px"}},[i._v("\n                          Selecciona una opción para todas las filas\n                        ")]):i._e()])]):i._e(),4==e.id_tipo&&i.campoVisible(e)?t("q-select",{attrs:{outlined:"","bg-color":"white",options:i.departamentos,"lazy-rules":"","emit-value":"","map-options":"","option-value":"nombre","option-label":"nombre",error:!e.isValid,"error-message":"Selecciona una opción",rules:[function(i){return i&&e.requerido||!e.requerido||"Selecciona una opción"}]},on:{input:function(t){return i.CargarMunicipios(e,e.respuesta,i.formulario.secciones[i.page].campos[o+1],!0)}},model:{value:e.respuesta,callback:function(t){i.$set(e,"respuesta",t)},expression:"campo.respuesta"}}):i._e(),5==e.id_tipo?t("q-select",{attrs:{outlined:"","bg-color":"white",options:i.municipios,"lazy-rules":"","emit-value":"","map-options":"","option-value":"nombre","option-label":"nombre",error:!e.isValid,"error-message":"Selecciona una opción",rules:[function(i){return i&&e.requerido||!e.requerido||"Selecciona una opción"}]},model:{value:e.respuesta,callback:function(t){i.$set(e,"respuesta",t)},expression:"campo.respuesta"}}):i._e(),6==e.id_tipo&&i.campoVisible(e)?t("div",[t("div",{staticClass:"row"},[t("q-rating",{attrs:{size:"2.5em",max:"10",color:"yellow",icon:"star_border","icon-selected":"star","no-dimming":"",error:!e.isValid,"error-message":"Selecciona una valoración",rules:[function(i){return i&&i.length>0&&e.requerido||!e.requerido||"Selecciona una valoración"}]},scopedSlots:i._u([{key:"tip-1",fn:function(){return[t("q-tooltip",[i._v("1")])]},proxy:!0},{key:"tip-2",fn:function(){return[t("q-tooltip",[i._v("2")])]},proxy:!0},{key:"tip-3",fn:function(){return[t("q-tooltip",[i._v("3")])]},proxy:!0},{key:"tip-4",fn:function(){return[t("q-tooltip",[i._v("4")])]},proxy:!0},{key:"tip-5",fn:function(){return[t("q-tooltip",[i._v("5")])]},proxy:!0},{key:"tip-6",fn:function(){return[t("q-tooltip",[i._v("6")])]},proxy:!0},{key:"tip-7",fn:function(){return[t("q-tooltip",[i._v("7")])]},proxy:!0},{key:"tip-8",fn:function(){return[t("q-tooltip",[i._v("8")])]},proxy:!0},{key:"tip-9",fn:function(){return[t("q-tooltip",[i._v("9")])]},proxy:!0},{key:"tip-10",fn:function(){return[t("q-tooltip",[i._v("10")])]},proxy:!0}],null,!0),model:{value:e.respuesta,callback:function(t){i.$set(e,"respuesta",t)},expression:"campo.respuesta"}})],1),t("div",{staticClass:"row"},[e.isValid||!e.requerido||e.respuesta?i._e():t("label",{staticClass:"q-mt-md",staticStyle:{color:"#c10015","font-size":"12px"}},[i._v("\n                          Selecciona una opción\n                        ")])])]):i._e()],1)])])}))],2)]),t("q-card-section",{},[t("div",{staticClass:"row",staticStyle:{"padding-right":"7.5px","padding-left":"7.5px"}},[i.page>0?t("q-btn",{staticClass:"col-4 col-md-1",on:{click:i.prevPage}},[i._v("\n                Atrás\n              ")]):i._e(),i.page<i.formulario.secciones.length?t("q-btn",{staticClass:"col-4 offset-4 col-md-2",class:i.page>0?"offset-md-9":"offset-md-10",attrs:{color:"primary"},on:{click:i.nextPage}},[i._v("\n                "+i._s(i.formulario.secciones.length-1==i.page?"Finalizar":"Siguiente")+"\n              ")]):i._e()],1)])],1)],1):i.finalizado?t("div",[t("q-card",[t("q-card-section",[t("div",{staticClass:"row",staticStyle:{display:"flex","justify-content":"center"}},[t("div",{staticClass:"col-12 col-md-2",staticStyle:{display:"flex","justify-content":"center","margin-bottom":"100px",padding:"20px"}},[t("q-img",{staticStyle:{height:"80px","max-width":"250px",display:"flex","justify-content":"center"},attrs:{src:"statics/imagenes-plantilla/logo1.png",cover:"",position:"center"}})],1),t("div",{staticClass:"row"},[t("div",{staticClass:"col-12 col-md-10",staticStyle:{display:"flex","justify-content":"center",margin:"auto","margin-bottom":"100px"}},[t("label",{staticStyle:{color:"#4998d4","font-size":"35px","text-align":"center"}},[i._v("\n                    GRACIAS POR COMPLETAR ESTE FORMULARIO!!\n                  ")])])])]),t("div",{staticClass:"row",staticStyle:{display:"flex","justify-content":"center"}},[t("q-btn",{attrs:{icon:"chevron_left"},on:{click:function(e){return i.$router.replace("/admin/formularios")}}},[i._v("\n                Regresar\n              ")])],1)])],1)],1):i._e(),t("q-dialog",{model:{value:i.modalOpen,callback:function(e){i.modalOpen=e},expression:"modalOpen"}},[t("q-card",{staticStyle:{width:"1024px","max-width":"80vw"}},[t("q-card-section",{staticClass:"bg-primary text-white q-gutter-sm"},[t("h5",[i._v("Seleccionar Participante")])]),t("q-separator"),t("q-card-section",[t("div",{staticClass:"row q-col-gutter-md"},[t("div",{staticClass:"col-12 col-md-4"},[t("q-option-group",{attrs:{options:i.multiples_coincidencias,label:"Participantes",type:"radio"},model:{value:i.participante,callback:function(e){i.participante=e},expression:"participante"}})],1)]),t("q-card-actions",{staticClass:"row justify-between q-gutter-sm"},[t("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{right:"",icon:"close"}},[i._v("Cancelar")]),t("q-btn",{staticClass:"bg-primary text-white",attrs:{loading:i.loading,disable:i.loading,right:"",icon:"save"},on:{click:i.seleccionarParticipante}},[i._v("\n                Seleccionar\n              ")])],1)],1)],1)],1)],1)],1)],1)},a=[],r=(t("6762"),t("2fdb"),t("c5f6"),t("a34a")),s=t.n(r),n=(t("7514"),t("96cf"),t("c973")),c=t.n(n),l=(t("3b2b"),t("c1df")),u=t.n(l),d=t("bc3a"),p=t.n(d),m=t("0a93"),f={data:function(){return{cantRespuestas:0,confirm:!1,loading:!1,timer:0,interval:null,segundos:0,minutos:0,slug_respuesta:null,participante:null,modalOpen:!1,multiples_coincidencias:[],formulario:null,reglas:[],reglasTabla:[],campos_excluidos:[],nombre:"Nombre del Formulario",page:0,iniciado:!1,doc_identidad:null,tipo_identidad:null,fecha_inicio:null,correoVerificado:!1,nombreUsuario:null,finalizado:!1,municipios:[],departamentos:[],seccionesVisibles:[],emailRegex:new RegExp(/^([a-zA-Z0-9_.-])+@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/),loadingCentros:!1,loadingCursos:!1,centros:[],cursos:[],tipos_identidad:[{label:"Cédula",value:"documento_identidad"},{label:"Correo",value:"correo"},{label:"Teléfono",value:"telefono"}],id_curso:null,id_centro:null,ratingColors:["light-green-1","light-green-2","light-green-3","light-green-4","light-green-5","light-green-6","light-green-7","light-green-8","green-9","green-10"]}},created:function(){var i=this;this.$route.params.slug&&(this.CargarDatosFormulario(),!this.$store.getters.online&&this.$q.platform.is.mobile?c()(s.a.mark((function e(){var t,o;return s.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,t=Object(m["i"])("Centro"),e.next=4,t.find();case 4:o=e.sent,i.centros=o,e.next=10;break;case 8:e.prev=8,e.t0=e["catch"](0);case 10:case"end":return e.stop()}}),e,null,[[0,8]])})))():(this.CargarCentros(),this.CargarCursos()),this.CargarDepartamentos("",!1))},methods:{campoVisible:function(i){var e=!0;return this.campos_excluidos.forEach((function(t){t.id==i.id&&(e=!1)})),e},excluirSeccion:function(i){this.seccionesVisibles=this.formulario.secciones.filter((function(e){return e.id!=i}))},excluirCampo:function(i,e){for(var t=0;t<this.formulario.secciones.length;t++)for(var o=this.formulario.secciones[t],a=o.campos,r=0;r<a.length;r++){var s=a[r];s.id==e&&this.campos_excluidos.push(s)}},validarSeccionesVisibles:function(){if(this.seccionesVisibles=this.formulario.secciones,this.campos_excluidos=[],0!=this.reglas.length)for(var i=0;i<this.formulario.secciones.length;i++)for(var e=this.formulario.secciones[i],t=e.campos,o=0;o<t.length;o++)for(var a=t[o],r=0;r<this.reglas.length;r++){var s=this.reglas[r],n=this.reglasTabla[r];if(a.id==s.campo_excluyente){var c=s.operacion,l=n.respuesta_excluyente;switch(c){case"=":1!=a.id_tipo&&2!=a.id_tipo||(a.respuesta==l&&(1==s.excluir_full_seccion?this.excluirSeccion(s.seccion_excluida):this.excluirCampo(s.seccion_excluida,s.campo_excluido,"operacion = campo.id_tipo 1 o 2")),2==a.id_tipo&&4==a.tipo_input.id&&u()(a.respuesta,"DD/MM/YYYY",!0).isSame(u()(l,"DD/MM/YYYY",!0))&&(1==s.excluir_full_seccion?this.excluirSeccion(s.seccion_excluida):this.excluirCampo(s.seccion_excluida,s.campo_excluido,"operacion = campo tipo fecha")));break;case"<":if((1==a.id_tipo||2==a.id_tipo)&&(a.respuesta<l&&(s.excluir_full_seccion?this.excluirSeccion(s.seccion_excluida):this.excluirCampo(s.seccion_excluida,s.campo_excluido,"operacion < campo.id_tipo 1 o 2")),2==a.id_tipo&&4==a.tipo_input.id)){var d=u()(a.respuesta,"DD/MM/YYYY",!0),p=u()(l,"DD/MM/YYYY",!0);d.isSameOrBefore(p)&&(1==s.excluir_full_seccion?this.excluirSeccion(s.seccion_excluida):this.excluirCampo(s.seccion_excluida,s.campo_excluido,"operacion < campo tipo fecha"))}break;case">":if((1==a.id_tipo||2==a.id_tipo)&&(a.respuesta>l&&(1==s.excluir_full_seccion?this.excluirSeccion(s.seccion_excluida):this.excluirCampo(s.seccion_excluida,s.campo_excluido,"operacion > campo.id_tipo 1 o 2")),2==a.id_tipo&&4==a.tipo_input.id)){var m=u()(a.respuesta,"DD/MM/YYYY",!0),f=u()(l,"DD/MM/YYYY",!0);m.isSameOrAfter(f),m.isSameOrAfter(f)&&(1==s.excluir_full_seccion?this.excluirSeccion(s.seccion_excluida):this.excluirCampo(s.seccion_excluida,s.campo_excluido,"operacion > campo tipo  fecha"))}break;case"!=":1!=a.id_tipo&&2!=a.id_tipo||(a.respuesta!=l&&(s.excluir_full_seccion?this.excluirSeccion(s.seccion_excluida):this.excluirCampo(s.seccion_excluida,s.campo_excluido,"operacion != campo.id_tipo 1 o 2")),2==a.id_tipo&&4==a.tipo_input.id&&u()(a.respuesta,"DD/MM/YYYY",!0)!=u()(l,"DD/MM/YYYY",!0)&&(s.excluir_full_seccion?this.excluirSeccion(s.seccion_excluida):this.excluirCampo(s.seccion_excluida,s.campo_excluido,"operacion != campo tipo fecha")));break;default:break}}}},stopTimer:function(){clearInterval(this.interval)},regresar:function(){this.$router.push({name:"formularios"})},validarMinimosYMaximos:function(i,e){return!i.minimo||!i.maximo||Number(e)>=Number(i.minimo)&&Number(e)<=Number(i.maximo)},CargarDepartamentos:function(){var i=this;if(this.loadingDepartamentos=!0,1==this.$store.getters.online){var e="http://35.203.165.142/api/catalogos/departamentos",t={Authorization:"Bearer "+this.$store.state.token},o={q:"",id_padre:1438};p()({method:"get",url:e,params:o,headers:t}).then((function(e){i.departamentos=e.data.departamentos,i.loadingDepartamentos=!1})).catch((function(e){i.loadingDepartamentos=!1}))}else{var a=Object(m["i"])("Departamento");a.find().then((function(e){i.departamentos=e,i.loadingDepartamentos=!1})).catch((function(e){i.loadingDepartamentos=!1}))}},CargarMunicipios:function(i,e,t){var o=this,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";if(null==e||0!=this.$store.getters.online){this.loadingMunicipios=!0;var s="http://35.203.165.142/api/catalogos/municipios";0==i.FiltrarXDepartamento&&(s="http://35.203.165.142/api/catalogos/TodosMunicipios");var n={Authorization:"Bearer "+this.$store.state.token};a&&(t.respuesta=null);var c={filtro:r,id_padre:null!=e?this.departamentos.filter((function(i){return i.nombre==e}))[0].id:""};p()({method:"get",url:s,params:c,headers:n}).then((function(i){o.municipios=i.data.municipios,o.loadingMunicipios=!1})).catch((function(i){o.loadingMunicipios=!1}))}else{a&&(t.respuesta=null);var l=this.departamentos.filter((function(i){return i.nombre==e}))[0],u=Object(m["i"])("Municipio");u.find({departamento:l}).then((function(i){o.municipios=i}))}},saveToLocalStorage:function(i,e){window.clearTimeout(this.timer),this.timer=window.setTimeout((function(){localStorage.setItem(i,JSON.stringify(e))}),500)},setFilaCheckbox:function(i,e,t){var o=this;e.columns.forEach((function(i,e,a){i.id!=t.id&&o.$set(i,"checked",!1)}));var a=i.arregloTable.length,r=0;i.arregloTable.forEach((function(i){i.columns.filter((function(i){return i.checked})).length>0&&(r+=1)}));var s=r==a;i.respuesta=i.arregloTable,i.isValid=s,this.$forceUpdate()},validarUsuario:function(){5603!=this.formulario.id_modo?this.correoVerificado=!0:this.validarCorreo(!1)},seleccionarParticipante:function(){var i=this;this.modalOpen=!1,this.correoVerificado=!0,this.formulario.participante={nombre:this.multiples_coincidencias.filter((function(e){return e.value==i.participante}))[0].label,id_participante:this.participante}},CargarCentros:function(){var i=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t="http://35.203.165.142/api/catalogos/centros_cursos",o={Authorization:"Bearer "+this.$store.state.token},a={q:e};p()({method:"get",url:t,params:a,headers:o}).then((function(e){i.centros=e.data.centros})).catch((function(i){}))},CargarCursos:function(i){var e=this;if(this.id_centro)if(this.loadingCursos=!0,!this.$store.getters.online&&this.$q.platform.is.mobile){var t=Object(m["i"])("Centro");t.findOne(this.id_centro,{relations:["cursos"]}).then((function(i){e.cursos=i.cursos,e.loadingCursos=!1,e.formulario.id_curso=null,e.id_curso=null})).catch((function(i){console.error("Error finding centro",i),e.cursos=null,e.loadingCursos=!1,e.formulario.id_curso=null,e.id_curso=null}))}else{var o="http://35.203.165.142/api/catalogos/cursos",a={Authorization:"Bearer "+this.$store.state.token},r={id_centro:this.id_centro};p()({method:"get",url:o,params:r,headers:a}).then((function(i){e.cursos=i.data.cursos,e.loadingCursos=!1,e.formulario.id_curso=null})).catch((function(i){e.loadingCursos=!1}))}},iniciarFormulario:function(){this.iniciado=!0;for(var i=0;i<this.formulario.secciones.length;i++){var e=this.formulario.secciones[i];e.campos}this.loading=!0;this.fecha_inicio=u()(),this.iniciarTimer()},iniciarTimer:function(){var i=this;this.interval=setInterval((function(){i.actualizarReloj()}),1e3)},actualizarReloj:function(){var i=u.a.duration(u()().diff(this.fecha_inicio));this.minutos=Number((Number(this.formulario.duracion)-Math.floor(i.asSeconds()/60).toFixed(0)-1).toFixed(0)),this.formulario.duracion=Number(this.formulario.duracion),this.minutos=(Number(this.formulario.duracion)-Math.floor(i.asSeconds()/60).toFixed(0)-1).toFixed(0),0==this.minutos&&this.stopTimer(),this.segundos=60-Number(Number(i.asSeconds()%60).toFixed(0))==0?1:60-Number(i.asSeconds()%60).toFixed(0),this.$forceUpdate(),this.formulario.duracion>0&&0==this.minutos&&(this.stopTimer(),this.finalizarFormulario(),this.segundos=0)},finalizarFormulario:function(){this.page=this.formulario.secciones.length-1,this.nextPage(!1)},validarCorreo:function(){var i=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.loading=!0;var t="post",o="http://35.203.165.142/api/verificar_identidad/formulario";if(this.$store.getters.online)p()({method:t,url:o,data:{slug:this.$route.params.slug,tipo_identidad:this.tipo_identidad,doc_identidad:this.doc_identidad,id_centro:this.id_centro,id_curso:this.id_curso,id_participante:this.formulario.participante?this.formulario.participante.id_participante:null,mostrar_multiples:e,nombre_participante:this.formulario.nombre_participante,correo_participante:this.formulario.correo_participante}}).then((function(t){return i.loading=!1,t.data.result&&(i.correoVerificado=!0,i.formulario.participante=t.data.participante),t.data.result||"completado"!=t.data.code?!t.data.result&&"multiples_coincidencias"==t.data.code&&e?(i.modalOpen=!0,void(i.multiples_coincidencias=t.data.multiples_coincidencias)):(t.data.result||"no_matricula"!=t.data.code||i.$q.notify({color:"red-5",textColor:"white",icon:"fas fa-exclamation-triangle",message:t.data.message}),void(0!=e&&(t.data.result||i.$q.notify({color:"red-5",textColor:"white",icon:"fas fa-exclamation-triangle",message:t.data.message})))):(i.iniciado=!0,i.finalizado=!0,void setTimeout((function(){localStorage.removeItem("formulario_respuestas_".concat(i.$route.params.slug))}),500))})).catch((function(e){i.loading=!1,i.$q.notify({color:"red-5",textColor:"white",icon:"fas fa-exclamation-triangle",message:e.response.data.message})}));else{var a=Object(m["i"])("Matriculas"),r={id_curso:this.id_curso};switch(this.tipo_identidad){case"documento_identidad":r.documento_identidad=this.doc_identidad;break;case"correo":r.correo=this.doc_identidad;break;case"telefono":r.telefono=this.doc_identidad;break;default:break}a.find(r).then((function(e){if(e.length<1)i.$q.notify({color:"red-5",textColor:"white",icon:"fas fa-exclamation-triangle",message:"Estudiante no encontrado en el curso seleccionado"});else if(e.length>1){for(var t=[],o=0;o<e.length;o++){var a=e[o];t.push({label:a.nombre,value:a.id_participante})}i.multiples_coincidencias=t,i.modalOpen=!0,i.loading=!1}else{i.correoVerificado=!0;var r=e[0];i.formulario.participante={nombre:r.nombre,id_participante:r.id_participante+""}}})).catch((function(e){console.error("Error fetching matriculas",e),i.$q.notify({color:"red-5",textColor:"white",icon:"fas fa-exclamation-triangle",message:"Estudiante no encontrado en el curso seleccionado"})}))}},validateForm:function(){var i=this,e=this.formulario.secciones[this.page];e.campos.forEach((function(e,t,o){if(e.requerido&&!e.respuesta&&3!==e.id_tipo)e.isValid=!1;else if(2==e.id_tipo&&4==e.tipo_input.id)e&&i.isValidDate(e.respuesta)&&/\d{1,2}\/\d{1,2}\/\d{4}/.test(e.respuesta)?e.isValid=!0:e.isValid=!1;else if(3==e.id_tipo){var a=0;e.arregloTable.forEach((function(i){i.columns.filter((function(i){return i.checked})).length>0?(a+=1,i.isValid=!0):i.isValid=!1})),a===e.arregloTable.length?(e.isValid=!0,i.formulario.secciones.forEach((function(i){i.campos.forEach((function(i,t,o){i.id===e.id&&(i.isValid=!0,e.isValid=!0)}))}))):e.isValid=!1}else e.isValid=!0;1==e.id_tipo&&2==e.tipo_input.id&&(e.isValid=e.requerido&&e.opciones.filter((function(i){return i.respuesta})).length>0||!e.requerido)}));var t=this.campos_excluidos.map((function(i){return i.id}));return e.campos.filter((function(i){return i.isValid&&!t.includes(i.id)})).length==e.campos.filter((function(i){return!t.includes(i.id)})).length},getPreviousSection:function(){if(0==this.page)return 0;var i=0;if(this.formulario.secciones.lenght!=this.seccionesVisibles.length){var e=this.formulario.secciones[this.page].id;return this.seccionesVisibles.forEach((function(t,o){t.id==e&&(i=o-1)})),i}return this.page-1},getNextSection:function(){if(this.page>=this.formulario.secciones.length-1)return this.page;var i=this.page;if(this.formulario.secciones.lenght!=this.seccionesVisibles.length){var e=this.seccionesVisibles[this.page+1].id;return this.formulario.secciones.forEach((function(t,o){t.id==e&&(i=o)})),i}return this.page+1},prevPage:function(){var i=this.getPreviousSection();this.page=i},nextPage:function(){var i=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!e||this.validateForm())if(this.page>=this.formulario.secciones.length-1){if(this.loading=!0,this.$q.platform.is.mobile&&!this.$store.getters.online){var t=Object(m["i"])("Respuestas"),o=u()().format("DD/MM/YYYY hh:mm:ss");this.formulario.id_curso=this.id_curso;var a=Object(m["i"])("Formulario");return void a.findOne({url:this.$route.params.slug}).then((function(e){i.formulario.id_formulario=e.id;try{var a=JSON.stringify(i.formulario),r={id_formulario:i.formulario.id_formulario,formulario:a,tipo_identidad:i.tipo_identidad,doc_identidad:i.doc_identidad,id_centro:i.id_centro,id_respuesta:-1*(new Date).getTime(),id_curso:i.id_curso,fecha_inicio:i.fecha_inicio,fecha_fin:o,id_participante:i.formulario.participante?i.formulario.participante.id_participante:-1,nombre_participante:i.formulario.participante?i.formulario.participante.nombre:null},s=i;t.save(r).then((function(e){localStorage.removeItem("formulario_respuestas_".concat(i.$route.params.slug)),s.$q.notify({color:"green-4",textColor:"white",icon:"fas fa-check-circle",message:"Formulario creado correctamente",position:"bottom",timeout:2e3}),s.finalizado=!0})).catch((function(i){console.error("Error guardando en sqlite",{error:i}),s.$q.notify({color:"red-5",textColor:"white",icon:"fas fa-exclamation-triangle",message:"Error al guardar",position:"bottom",timeout:2e3})}))}catch(n){console.error("Error trying to store data to SQLITE ",n)}}))}var r="post",s={Authorization:"Bearer "+this.$store.state.token},n="http://35.203.165.142/api/responder/formulario/"+this.$route.params.slug;p()({method:r,url:n,data:{formulario:this.formulario,tipo_identidad:this.tipo_identidad,doc_identidad:this.doc_identidad,id_centro:this.id_centro,id_curso:this.id_curso,fecha_inicio:this.fecha_inicio},headers:s}).then((function(e){i.finalizado=!0,setTimeout((function(){localStorage.removeItem("formulario_respuestas_".concat(i.$route.params.slug))}),500),i.$q.notify({color:"green-4",textColor:"white",icon:"fas fa-check-circle",message:"Formulario creado correctamente",position:"bottom",timeout:2e3})})).catch((function(e){i.load,i.$q.notify({color:"red-5",textColor:"white",icon:"fas fa-exclamation-triangle",message:e.response.data})}))}else this.page=this.getNextSection(),this.formulario.secciones[this.page].campos.forEach((function(e,t,o){i.$set(e,"isValid",!0)})),window.scrollTo({left:0,top:80,behavior:"smooth"});else this.$q.notify({color:"red-5",textColor:"white",icon:"fas fa-exclamation-triangle",message:"Por favor complete todos los campos"})},shuffle:function(i){var e,t,o=i.length;while(0!=o)t=Math.floor(Math.random()*o),o-=1,e=i[o],i[o]=i[t],i[t]=e;return i},showDatePopUp:function(i){this.$refs[i][0].show()},hideDatePopUp:function(i){this.$refs[i][0].hide()},isValidDate:function(i){return u()(i,"DD/MM/YYYY",!0).isValid()},continuar:function(){var i=JSON.parse(localStorage.getItem("formulario_respuestas_".concat(this.$route.params.slug))||null);i&&(this.correoVerificado=!0,this.iniciado=!0,this.formulario=i.formulario,this.iniciado=i.iniciado,this.doc_identidad=i.doc_identidad,this.tipo_identidad=i.tipo_identidad,this.fecha_inicio=i.fecha_inicio,this.correoVerificado=i.correoVerificado,this.nombreUsuario=i.nombreUsuario,this.finalizado=i.finalizado,this.id_curso=i.id_curso,this.id_centro=i.id_centro,this.confirm=!1,this.finalizado=!1,this.reglas=i.reglas,this.reglasTabla=i.reglasTabla)},inicializarValoresPorDefectoFormulario:function(i){var e=this;for(var t in i.secciones){var o=i.secciones[t].campos;for(var a in o){var r=o[a];r.isValid=!0,1==r.id_tipo&&2==r.tipo_input.id&&r.opciones.forEach((function(i,e,t){i.respuesta=!1})),2==r.id_tipo&&4==r.tipo_input.id&&(r.respuesta=u()().format("DD/MM/YYYY")),1==r.id_tipo&&1==r.tipo_input.id&&(r.respuesta=!1),2==r.id_tipo&&3==r.tipo_input.id&&(r.respuesta=null),1==r.id_tipo&&2==r.tipo_input.id&&(r.respuesta=!1),6==r.id_tipo&&(r.respuesta=0)}}5561==i.id_tipo&&1==i.ordenar_aleatoriamente&&i.secciones.forEach((function(i){i.campos=e.shuffle(i.campos),i.campos.forEach((function(i){i.opciones=e.shuffle(i.opciones)}))})),this.formulario=JSON.parse(JSON.stringify(i)),this.seccionesVisibles=this.formulario.secciones},nuevoFormulario:function(){localStorage.removeItem("formulario_respuestas_".concat(this.$route.params.slug)),this.CargarDatosFormulario(),this.confirm=!1},CargarDatosFormulario:function(){var i=this;if(!this.finalizado){localStorage.getItem("formulario_respuestas_".concat(this.$route.params.slug));var e=JSON.parse(localStorage.getItem("formulario_respuestas_".concat(this.$route.params.slug))||null);if(e&&e.formulario.url==this.$route.params.slug)return void(this.confirm=!0)}if(this.$route.params.slug)if(this.loading=!0,!this.$store.getters.online&&this.$q.platform.is.mobile){var t=Object(m["i"])("Formulario");t.find({url:this.$route.params.slug}).then((function(e){var t=e[0];t.secciones=JSON.parse(t.secciones),i.inicializarValoresPorDefectoFormulario(t),5605==i.formulario.id_modo&&i.iniciarFormulario()})).catch((function(e){i.$q.notify({color:"red-5",textColor:"white",icon:"fas fa-exclamation-triangle",message:e.response.data})}))}else{var o="http://35.203.165.142/api"+"/responder/formulario/".concat(this.$route.params.slug),a={Authorization:"Bearer "+this.$store.state.token};p()({method:"get",url:o,headers:a}).then((function(e){if(0!=e.data.result){var t=e.data.formulario,o=e.data.campos;if(t.secciones=e.data.secciones,o.forEach((function(i,e,t){t[e].tipo_input=JSON.parse(i.tipo_input),t[e].opciones=JSON.parse(i.opciones),3==i.id_tipo&&(t[e].arregloTable=JSON.parse(i.arregloTable)),i.imagen_url=i.imagen})),t.secciones.forEach((function(i,e,t){t[e].campos=o.filter((function(e){return e.id_seccion==i.id}))})),t.reglas){var a=JSON.parse(t.reglas);a&&(i.reglas=a.reglas,i.reglasTabla=a.reglasTabla)}t.id=Number(t.id),t.id_tipo=Number(t.id_tipo),t.id_tema=Number(t.id_tema),t.id_centro=Number(t.id_centro),t.id_curso=Number(t.id_curso),t.id_modo=Number(t.id_modo),i.inicializarValoresPorDefectoFormulario(t),5605==i.formulario.id_modo&&i.iniciarFormulario()}else i.$q.notify({color:"red-5",textColor:"white",icon:"fas fa-exclamation-triangle",message:e.data.message})})).catch((function(e){i.loading=!1,i.$q.notify({color:"red-5",textColor:"white",icon:"fas fa-exclamation-triangle",message:e.response.data})}))}}},computed:{ancho:function(){var i=this.$q.screen.lt,e=500;return i.xs||i.sm?(e=0,window.screen.width-e+"px"):i.md?(e=150,window.screen.width-e+"px"):i.lg?(e=250,window.screen.width-e+"px"):i.xl?(e=500,window.screen.width-e+"px"):window.screen.width-e+"px"},app_url:function(){return"http://34.72.90.164/"},cantidad_campos:function(){for(var i=0,e=this.formulario.secciones[this.page],t=0;t<e.campos.length;t++){var o=e.campos[t];null==o.respuesta||0==o.respuesta||2==o.id_tipo&&4==o.tipo_input.id||(i+=1)}return i}},watch:{formulario:{handler:function(i){this.cantidad_campos,1==this.iniciado&&this.cantidad_campos>0&&0==this.finalizado&&this.saveToLocalStorage("formulario_respuestas_".concat(this.$route.params.slug),{formulario:i,iniciado:this.iniciado,finalizado:this.finalizado,doc_identidad:this.doc_identidad,tipo_identidad:this.tipo_identidad,fecha_inicio:this.fecha_inicio,correoVerificado:this.correoVerificado,nombreUsuario:this.nombreUsuario,id_curso:this.id_curso,id_centro:this.id_centro,reglas:this.reglas,reglasTabla:this.reglasTabla,timer:this.timer,interval:this.interval,segundos:this.segundos,minutos:this.minutos,municipios:this.municipios,departamentos:this.municipios,seccionesVisibles:this.seccionesVisibles}),this.validarSeccionesVisibles()},deep:!0},page:function(){this.validarSeccionesVisibles()}}},h=f,_=(t("a5b0"),t("2877")),g=Object(_["a"])(h,o,a,!1,null,null,null);e["default"]=g.exports}}]);